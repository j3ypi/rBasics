<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inferenzstatistik • rBasics</title>
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Inferenzstatistik">
<meta property="og:description" content="">
<meta property="og:image" content="https://github.com/j3ypi/rBasics/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rBasics</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_Setup.html">Setup</a>
    </li>
    <li>
      <a href="../articles/02_Datenvorbereitung.html">Datenvorbereitung</a>
    </li>
    <li>
      <a href="../articles/03_Deskriptive_Statistik.html">Deskriptive Statistik</a>
    </li>
    <li>
      <a href="../articles/04_Visualisierungen.html">Visualisierungen</a>
    </li>
    <li>
      <a href="../articles/05_Inferenzstatistik.html">Inferenzstatistik</a>
    </li>
    <li>
      <a href="../articles/06_Extras.html">Extras</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    PDFs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../pdfs/01_Setup.pdf">Setup</a>
    </li>
    <li>
      <a href="../pdfs/02_Datenvorbereitung.pdf">Datenvorbereitung</a>
    </li>
    <li>
      <a href="../pdfs/03_Deskriptive_Statistik.pdf">Deskriptive Statistik</a>
    </li>
    <li>
      <a href="../pdfs/04_Visualisierungen.pdf">Visualisierungen</a>
    </li>
    <li>
      <a href="../pdfs/05_Inferenzstatistik.pdf">Inferenzstatistik</a>
    </li>
    <li>
      <a href="../pdfs/06_Extras.pdf">Extras</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Dokumentation</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/j3ypi/rBasics">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Inferenzstatistik</h1>
            <h3 class="subtitle">R für empirische Wissenschaften v1.0.2</h3>
                        <h4 class="author">Jan Philipp Nolte</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/j3ypi/rBasics/blob/master/vignettes/05_Inferenzstatistik.Rmd"><code>vignettes/05_Inferenzstatistik.Rmd</code></a></small>
      <div class="hidden name"><code>05_Inferenzstatistik.Rmd</code></div>

    </div>

    
    

<div id="einfuhrung" class="section level1">
<h1 class="hasAnchor">
<a href="#einfuhrung" class="anchor"></a>Einführung</h1>
<p>Viele inferenzstatistische Verfahren sind direkt in R integriert. Ein paar Verfahren müssen wir jedoch mit externen Packages rechnen. Leider ist weder in <code>Base R</code> noch in den Packages eine wirklich konsistente, Pipe-freundliche Syntax gegeben. Außerdem sind die Outputs unbearbeitet nicht übersichtlich lesbar. Im Folgenden schauen wir uns diverse statistische Verfahren an und lassen uns die Ergebnisse in schöner Form mit Funktionen des <code>broom</code> (engl. für Besen) Packages wiedergeben. Aber dazu später mehr. Das Ziel dieses Kapitel ist das Vorstellen der Funktionen mit ihren Argumenten. Es dient mehr als Komprehendium zum Nachschlagen, allerdings sollte man den grundlegenden Workflow verstanden und sich vor allem den Exkurs zu <a href="#exkurs-dollar-operator">Dollar-Operatoren</a> angeschaut haben. Bevor wir in die Inferenzstatistik eintauchen, schauen wir uns zuerst die Stichprobenplanung und Power-Berechnung an.</p>
</div>
<div id="stichprobenplanung-und-power" class="section level1">
<h1 class="hasAnchor">
<a href="#stichprobenplanung-und-power" class="anchor"></a>Stichprobenplanung und Power</h1>
<p>Sowohl für die Stichprobenplanung als auch für die Power-Berechenung benötigen wir das Package <code>pwr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pwr)</code></pre></div>
<p>Möchten wir nun zum Beispiel die optimale Stichprobengröße für eine ANOVA mit zwei Gruppen <code>k</code>, einer erwarteten Effektstärke <code>f</code> von .3 und einem <span class="math inline">\(\alpha\)</span>-Niveau von 5% bei einer Power von 0.8 erhalten, benutzen wir <code><a href="http://www.rdocumentation.org/packages/pwr/topics/pwr.anova.test">pwr.anova.test()</a></code> und setzen ein.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/pwr/topics/pwr.anova.test">pwr.anova.test</a></span>(<span class="dt">k =</span> <span class="dv">2</span>,  
               <span class="dt">f =</span> <span class="fl">0.3</span>, 
               <span class="dt">sig.level =</span> <span class="fl">0.05</span>,
               <span class="dt">power =</span> <span class="fl">0.8</span>)</code></pre></div>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 2
##               n = 44.58577
##               f = 0.3
##       sig.level = 0.05
##           power = 0.8
## 
## NOTE: n is number in each group</code></pre>
<p>Für andere Verfahren gibt es nach dem gleichen Schema entsprechende Funktionen (beispielsweise <code><a href="http://www.rdocumentation.org/packages/pwr/topics/pwr.t.test">pwr.t.test()</a></code>). Wenn man Post-Hoc die Power ausrechnen möchte, verwendet man die selbe Funktion. Anstelle des power Arguments schreiben wir aber diesmal die beobachtete Stichprobengrösse <code>n</code> als Argument in die Funktion. Beachte, dass <code>f</code> auch hier die erwartete und nicht die beobachtete Effektstärke ist!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/pwr/topics/pwr.anova.test">pwr.anova.test</a></span>(<span class="dt">k =</span> <span class="dv">2</span>,  
               <span class="dt">n =</span> <span class="dv">30</span>, 
               <span class="dt">f =</span> <span class="fl">0.3</span>, 
               <span class="dt">sig.level =</span> <span class="fl">0.05</span>)</code></pre></div>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 2
##               n = 30
##               f = 0.3
##       sig.level = 0.05
##           power = 0.6275046
## 
## NOTE: n is number in each group</code></pre>
<p>Falls die Stichprobenplanung für den gewünschten Test nicht in <code>pwr</code> implementiert ist, sei an dieser Stelle auf <a href="http://gpower.hhu.de/">g*Power</a> verwiesen.</p>
</div>
<div id="exkurs-dollar-operator" class="section level1">
<h1 class="hasAnchor">
<a href="#exkurs-dollar-operator" class="anchor"></a>Exkurs: Dollar-Operator</h1>
<p>Während der Inferenzstatistik lässt es sich leider nicht vermeiden, ab und an das Dollarzeichen zu verwenden, um eine Spalte des Datensatzes auszuwählen. Warum geht es hier nicht einfach zuvor mit <code>select()</code>? Schauen wir uns mal genauer an, was die beiden Befehle jeweils zurückgeben.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tipp_wm <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Person)</code></pre></div>
<pre><code>## # A tibble: 384 x 1
##    Person      
##    &lt;chr&gt;       
##  1 Thomas_Bayes
##  2 Thomas_Bayes
##  3 Thomas_Bayes
##  4 Thomas_Bayes
##  5 Thomas_Bayes
##  6 Thomas_Bayes
##  7 Thomas_Bayes
##  8 Thomas_Bayes
##  9 Thomas_Bayes
## 10 Thomas_Bayes
## # ... with 374 more rows</code></pre>
<p>Während <code>select()</code> einen tibble mit der ausgewählten Spalte zurückgibt, erhält man durch den Dollar-Operator einen Vektor. Was genau Vektoren ausmachen, ist an dieser Stelle nicht weiter wichtig und wird deshalb unter Extras erläutert. Um die Spalte ausgeben zu lassen, hat man immer das selbe Schema: <code>datensatzName$spaltenName</code>. Wollen wir aus dem Datensatz <code>tipp_wm</code> die Spalte Person herausziehen, schreiben wir einfach</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tipp_wm<span class="op">$</span>Person</code></pre></div>
<pre><code>##  [1] "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes"
##  [5] "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes"
##  [9] "Thomas_Bayes" "Thomas_Bayes"</code></pre>
</div>
<div id="voraussetzungen-prufen" class="section level1">
<h1 class="hasAnchor">
<a href="#voraussetzungen-prufen" class="anchor"></a>Voraussetzungen prüfen</h1>
<p>Um zu entscheiden, welchen Test wir verwenden dürfen, müssen wir erst die Voraussetzungen prüfen.</p>
<div id="normalverteilung" class="section level2">
<h2 class="hasAnchor">
<a href="#normalverteilung" class="anchor"></a>Normalverteilung</h2>
<p>Am besten prüft man die Normalverteilung rein graphisch mit Q-Q Plots.</p>
<div id="q-q-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#q-q-plot" class="anchor"></a>Q-Q Plot</h3>
<p>Dafür verwenden wir erneut das Package <code>ggpubr</code> (siehe Kapitel Visualisierungen).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggpubr)</code></pre></div>
<p>Als erstes Argument übergeben wir den Namen des Datensatzes. In Anführungszeichen schreiben wir als zweites Argument die zu überprüfende Spalte.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggpubr/topics/ggqqplot">ggqqplot</a></span>(big_five, <span class="st">"Extraversion"</span>)</code></pre></div>
<p><img src="05_Inferenzstatistik_files/figure-html/unnamed-chunk-8-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div id="shapiro-wilks-test" class="section level3">
<h3 class="hasAnchor">
<a href="#shapiro-wilks-test" class="anchor"></a>Shapiro-Wilks Test</h3>
<p>Alternativ kann auch der Shapiro-Wilks Test verwendet werden. Hier verwenden wir zum ersten mal die Dollar-Syntax. Der Funktion übergeben wir die Spalte <code>Extraversion</code> aus dem Datensatz <code>big_five</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shapiro.test</span>(big_five<span class="op">$</span>Extraversion)</code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  big_five$Extraversion
## W = 0.95715, p-value = 9.845e-06</code></pre>
<p>Nun sieht der p-Wert etwas seltsam aus. Bei SPSS und Stata wird unter .001 nur noch &lt;.001 angezeigt. In <code>base R</code> hingegen wird bis 2e-16, also <span class="math inline">\(2 \times 10^{-16}\)</span> (0.0000000000000002) differenziert. Mit dem <code>broom</code> Package gibt es keine Untergrenze.</p>
</div>
<div id="kolgomorov-smirnov-test" class="section level3">
<h3 class="hasAnchor">
<a href="#kolgomorov-smirnov-test" class="anchor"></a>Kolgomorov-Smirnov Test</h3>
<p>Die zu überprüfende Spalte wird genau wie beim Shapiro Wilks Test übergeben. Zusätzlich muss noch <code>rnorm</code> in Anführungszeichen zum Testen auf Normalverteilung übergeben werden.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ks.test</span>(big_five<span class="op">$</span>Extraversion, <span class="st">"rnorm"</span>)</code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  big_five$Extraversion
## D = 3.8099, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
</div>
</div>
<div id="varianzhomogenitat" class="section level2">
<h2 class="hasAnchor">
<a href="#varianzhomogenitat" class="anchor"></a>Varianzhomogenität</h2>
<p>Auch beim Testen der Varianzhomogenität gibt es drei bekannte Verfahren. Ab hier werden wir versuchen, ein konsistentes Schema zum Testen zu entwickeln.</p>
<div id="f-test" class="section level3">
<h3 class="hasAnchor">
<a href="#f-test" class="anchor"></a>F-Test</h3>
<p>Zuerst rufen wir den F-Test mit <code>var.test()</code> auf. Angenommen wir möchten Extraversion zwischen den Geschlechtern auf Varianzhomogenität prüfen. Getrennt werden die Variablen durch eine sogenannte Tilde (~). Diese Schreibweise ist zwingend notwendig, wenn man als zweite Spalte eine kategorisierende Spalte wie Geschlecht (zwei Ausprägungsgrade) der Funktion übergibt. Um schön formatierte Ergebnisse zu erhalten, rufen wir zuletzt <code>tidy()</code> auf, welches eine Funktion aus dem bereits erwähnten <code>broom</code> Package ist, auf das wir ständig zurückgreifen werden. Zuerst müssen wir also das Package laden. Da wir wieder die Pipe verwenden, müssen wir selbstverständlich auch das <code>tidyverse</code> wieder laden.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(broom)
<span class="kw">library</span>(tidyverse)</code></pre></div>
<p>Nun können wir den F-Test rechnen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var.test</span>(Extraversion <span class="op">~</span><span class="st"> </span>Geschlecht, <span class="dt">data =</span> big_five) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## Multiple parameters; naming those columns num.df, denom.df</code></pre>
<pre><code>## # A tibble: 1 x 9
##   estimate `num df` `denom df` statistic p.value conf.low conf.high method
##      &lt;dbl&gt;    &lt;int&gt;      &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1     1.19      117         81      1.19   0.413    0.787      1.76 F tes~
## # ... with 1 more variable: alternative &lt;chr&gt;</code></pre>
<p>Die Spalte <code>statistic</code> enthält die jeweilige Teststatistik – in dem Fall den F-Wert. Man kann den F-Test mit <code>alternative</code> für einseitig oder zweiseitige Tests und mit <code>conf.level</code> das <span class="math inline">\(\alpha\)</span> Niveau anpassen. Nun wollen wir die Varianzhomogenität zwischen <code>Extraversion</code> und <code>Neurotizismus</code> überprüfen. Exemplarisch seien hier die veränderbaren zusätzlichen Argumente mit aufgelistet. Dies ist allerdings für Dich nur notwendig, wenn Du die Argumente verändern möchtest. Weil die zweite Variable keine kategorisierende ist, müssen wir wieder auf die Dollar-Syntax zurückgreifen (<code>datenName$spaltenName</code>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var.test</span>(big_five<span class="op">$</span>Extraversion, big_five<span class="op">$</span>Neurotizismus,
         <span class="dt">alternative =</span> <span class="st">"two.sided"</span>,
         <span class="dt">conf.level =</span> <span class="fl">0.95</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## Multiple parameters; naming those columns num.df, denom.df</code></pre>
<pre><code>## # A tibble: 1 x 9
##   estimate `num df` `denom df` statistic  p.value conf.low conf.high method
##      &lt;dbl&gt;    &lt;int&gt;      &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1    0.258      199        199     0.258 3.55e-20    0.196     0.342 F tes~
## # ... with 1 more variable: alternative &lt;chr&gt;</code></pre>
</div>
<div id="bartletts-test" class="section level3">
<h3 class="hasAnchor">
<a href="#bartletts-test" class="anchor"></a>Bartletts Test</h3>
<p>Der Bartletts Test funktioniert wie der F-Test. Nur können hier keine zusätzlichen Argumente übergeben werden.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bartlett.test</span>(big_five<span class="op">$</span>Extraversion <span class="op">~</span><span class="st"> </span>big_five<span class="op">$</span>Geschlecht) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   statistic p.value parameter method                                   
##       &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                                    
## 1     0.690   0.406         1 Bartlett test of homogeneity of variances</code></pre>
</div>
<div id="levene-test" class="section level3">
<h3 class="hasAnchor">
<a href="#levene-test" class="anchor"></a>Levene Test</h3>
<p>Für den Levene Test benötigen wir mit <code>car</code> ein externes Packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)</code></pre></div>
<p>Die Funktion ist leider nicht konsistent benannt, da der Funktionsname von keinem Punkt getrennt und zusätzlich das zweite Wort (Test) groß geschrieben wird. Also Achtung vor Tippfehlern! Ansonsten funktioniert hier alles wie gewohnt.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/car/topics/leveneTest">leveneTest</a></span>(big_five<span class="op">$</span>Extraversion, big_five<span class="op">$</span>Geschlecht) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## Warning in leveneTest.default(big_five$Extraversion, big_five$Geschlecht):
## big_five$Geschlecht coerced to factor.</code></pre>
<pre><code>## # A tibble: 2 x 4
##   term     df  statistic p.value
##   &lt;chr&gt; &lt;int&gt;      &lt;dbl&gt;   &lt;dbl&gt;
## 1 group     1  0.0000925   0.992
## 2 ""      198 NA          NA</code></pre>
</div>
</div>
</div>
<div id="testen" class="section level1">
<h1 class="hasAnchor">
<a href="#testen" class="anchor"></a>Testen</h1>
<p>Sind alle Voraussetzungen geprüft, geht es ans Testen.</p>
<div id="mittelwertsvergleich" class="section level2">
<h2 class="hasAnchor">
<a href="#mittelwertsvergleich" class="anchor"></a>Mittelwertsvergleich</h2>
<p>Zwischen abhängigen und unabhängigen t-Tests sowie zwischen t-Test und Welch-Test besteht in R kaum ein syntaktischer Unterschied.</p>
<div id="t-test" class="section level3">
<h3 class="hasAnchor">
<a href="#t-test" class="anchor"></a>t-Test</h3>
<p>Schauen wir uns zuerst die grundlegende Funktion <code>t.test()</code> an. Dabei ändert sich nichts im Vergleich zu den vorherigen Tests auf Varianzhomogenität. Auch hier haben wir die Unterteilung durch die Tilde (<code>~</code>), wenn die zweite Spalte kategorisierend ist und die Dollar-Syntax bei zwei intervallskalierten Variablen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(Extraversion <span class="op">~</span><span class="st"> </span>Geschlecht, <span class="dt">data =</span> big_five,
       <span class="dt">paired =</span> <span class="ot">FALSE</span>,
       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 1 x 9
##   estimate1 estimate2 statistic p.value parameter conf.low conf.high method
##       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1      3.05      3.11     -1.27   0.204       198   -0.162    0.0347 " Two~
## # ... with 1 more variable: alternative &lt;chr&gt;</code></pre>
<p>Die Argumente <code>alternative</code> und <code>conf.level</code> können auch hier geändert werden. Entscheidend für einen abhängigen oder unabhängigen t-Test ist jedoch das <code>paired</code> Argument. Setze es auf <code>TRUE</code> für abhängige und auf <code>FALSE</code> für unabhängige Stichproben. Das Argument <code>var.equal</code> besagt, dass wir von Varianzhomogenität ausgehen (also einen t-test machen).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(big_five<span class="op">$</span>Extraversion, big_five<span class="op">$</span>Neurotizismus,
       <span class="dt">alternative =</span> <span class="st">"two.sided"</span>, 
       <span class="dt">conf.level =</span> <span class="fl">0.95</span>, 
       <span class="dt">paired =</span> <span class="ot">FALSE</span>,
       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 1 x 9
##   estimate1 estimate2 statistic p.value parameter conf.low conf.high method
##       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1      3.08      3.13     -1.05   0.292       398   -0.163    0.0493 " Two~
## # ... with 1 more variable: alternative &lt;chr&gt;</code></pre>
</div>
<div id="welch-test" class="section level3">
<h3 class="hasAnchor">
<a href="#welch-test" class="anchor"></a>Welch-Test</h3>
<p>Bei heterogenen Varianzen muss man zum Verwenden des nicht-parametrischen Welch-Tests lediglich das <code>var.equal</code> Argument auf <code>FALSE</code> setzen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(big_five<span class="op">$</span>Extraversion, big_five<span class="op">$</span>Neurotizismus,
       <span class="dt">alternative =</span> <span class="st">"two.sided"</span>, 
       <span class="dt">conf.level =</span> <span class="fl">0.95</span>, 
       <span class="dt">paired =</span> <span class="ot">FALSE</span>,
       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 1 x 10
##   estimate estimate1 estimate2 statistic p.value parameter conf.low
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1  -0.0570      3.08      3.13     -1.05   0.293      295.   -0.163
## # ... with 3 more variables: conf.high &lt;dbl&gt;, method &lt;chr&gt;,
## #   alternative &lt;chr&gt;</code></pre>
<p>In der <code>method</code> Spalte im Output steht nun auch <code>Welch</code>.</p>
</div>
<div id="cohensd" class="section level3">
<h3 class="hasAnchor">
<a href="#cohensd" class="anchor"></a>Cohens’d</h3>
<p>Für die Effektstärke nach Cohen laden wir das Package <code>effsize</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(effsize)</code></pre></div>
<p>Auch hier kommt die Dollar-Syntax zum Einsatz.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/effsize/topics/cohen.d">cohen.d</a></span>(big_five<span class="op">$</span>Extraversion, big_five<span class="op">$</span>Neurotizismus) </code></pre></div>
<pre><code>## 
## Cohen's d
## 
## d estimate: -0.1054057 (negligible)
## 95 percent confidence interval:
##         inf         sup 
## -0.30213641  0.09132499</code></pre>
<p>In Klammern hinter der Effekstärke steht sogar direkt eine Einordnung über die Größe.</p>
</div>
</div>
<div id="regressionsanalysen" class="section level2">
<h2 class="hasAnchor">
<a href="#regressionsanalysen" class="anchor"></a>Regressionsanalysen</h2>
<p>Auch bei Regressionsanalysen ändert sich nicht viel. Wichtig ist ab jetzt nur, dass die abhängige Variable auf der linken Seite der Tilde (<code>~</code>) steht und die unabhängigen Variablen auf der rechten Seite. Der Befehl heißt <code>lm()</code>, was für linear model steht.</p>
<div id="einfache-lineare-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#einfache-lineare-regression" class="anchor"></a>Einfache Lineare Regression</h3>
<p>Eine einfache lineare Regression erhalten wir noch nach genau dem selben Schema wie zuvor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(Extraversion <span class="op">~</span><span class="st"> </span>Neurotizismus, <span class="dt">data =</span> big_five) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   term          estimate std.error statistic  p.value
##   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)     2.96      0.116     25.7   7.01e-65
## 2 Neurotizismus   0.0354    0.0360     0.984 3.27e- 1</code></pre>
</div>
<div id="multiple-lineare-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-lineare-regression" class="anchor"></a>Multiple Lineare Regression</h3>
<p>Möchten wir jetzt mehrere unabhängige Variablen auf Einfluss prüfen, müssen wir diese nur mit einem Pluszeichen hinzufügen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(Extraversion <span class="op">~</span><span class="st"> </span>Neurotizismus <span class="op">+</span><span class="st"> </span>Geschlecht, <span class="dt">data =</span> big_five) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   term          estimate std.error statistic  p.value
##   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)     2.90      0.123      23.5  5.95e-59
## 2 Neurotizismus   0.0469    0.0367      1.28 2.03e- 1
## 3 Geschlechtm     0.0768    0.0508      1.51 1.32e- 1</code></pre>
<p>Wenn wir eine Interaktion zwischen Neurotizismus und Geschlecht erwarten würden, müsste man nur das Pluszeichen durch ein Multiplikationszeichen ersetzen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(Extraversion <span class="op">~</span><span class="st"> </span>Neurotizismus <span class="op">*</span><span class="st"> </span>Geschlecht, <span class="dt">data =</span> big_five) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 4 x 5
##   term                      estimate std.error statistic  p.value
##   &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)                3.04       0.167    18.2    5.39e-44
## 2 Neurotizismus              0.00374    0.0504    0.0741 9.41e- 1
## 3 Geschlechtm               -0.207      0.233    -0.889  3.75e- 1
## 4 Neurotizismus:Geschlechtm  0.0917     0.0735    1.25   2.14e- 1</code></pre>
<p>Denke daran, dass <span class="math inline">\(e-1\)</span> für <span class="math inline">\(\times 10^{-1}\)</span> steht. Der p-Wert zur Interaktion wäre also <span class="math inline">\(0.214\)</span>.</p>
</div>
<div id="informationskriterien-und-r2" class="section level3">
<h3 class="hasAnchor">
<a href="#informationskriterien-und-r2" class="anchor"></a>Informationskriterien und <span class="math inline">\(R^2\)</span>
</h3>
<p>Natürlich interessiert uns nicht nur der p-Wert, sondern auch die Effektstärke <span class="math inline">\(R^2\)</span> und die Informationskriterien (AIC, BIC). Anstelle von <code>tidy()</code> schreiben wir dafür einfach <code>glance()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(Extraversion <span class="op">~</span><span class="st"> </span>Neurotizismus <span class="op">*</span><span class="st"> </span>Geschlecht, <span class="dt">data =</span> big_five) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">glance</span>()</code></pre></div>
<pre><code>## # A tibble: 1 x 11
##   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
## *     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1    0.0240       0.00911 0.345      1.61   0.188     4  -68.9  148.  164.
## # ... with 2 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;</code></pre>
</div>
<div id="logistische-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#logistische-regression" class="anchor"></a>Logistische Regression</h3>
<p>Für eine logistische Regression ändert sich der Befehl zu <code>glm()</code> (für Generalized linear model). Der Rest bleibt gleich. Zum exemplarischen Rechnen, müssen wir erst das Geschlecht numerisch kodieren.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">big_five_new &lt;-<span class="st"> </span>big_five <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggpubr/topics/reexports">mutate</a></span>(<span class="dt">Geschlecht =</span> <span class="kw">if_else</span>(Geschlecht <span class="op">==</span><span class="st"> "m"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</code></pre></div>
<p>Nun können wir wie gewohnt das Modell aufstellen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glm</span>(Geschlecht <span class="op">~</span><span class="st"> </span>Neurotizismus, <span class="dt">data =</span> big_five_new) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   term          estimate std.error statistic     p.value
##   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 (Intercept)      0.878    0.161       5.44 0.000000154
## 2 Neurotizismus   -0.149    0.0503     -2.97 0.00337</code></pre>
</div>
<div id="hierarchische-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#hierarchische-regression" class="anchor"></a>Hierarchische Regression</h3>
<p>Eine hierarchische Regression ist nichts anderes als das Vergleichen verschiedener linearer Modelle unter Hinzufügen von Variablen. Wir werden für eine größere Übersichtlichkeit die Modelle diesmal in Variablen speichern. Beachte, dass wir hier kein <code>tidy()</code> aufrufen, da wir die Informationskriterien der linearen Modelle später mit <code>glance()</code> vergleichen wollen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Extraversion <span class="op">~</span><span class="st"> </span>Neurotizismus, <span class="dt">data =</span> big_five) 
model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(Extraversion <span class="op">~</span><span class="st"> </span>Neurotizismus <span class="op">+</span><span class="st"> </span>Geschlecht, <span class="dt">data =</span> big_five)
model3 &lt;-<span class="st"> </span><span class="kw">lm</span>(Extraversion <span class="op">~</span><span class="st"> </span>Neurotizismus <span class="op">+</span><span class="st"> </span>Geschlecht <span class="op">+</span><span class="st"> </span>Offenheit, <span class="dt">data =</span> big_five) </code></pre></div>
<p>Um die Modelle nun zu vergleichen, rufen wir drei mal <code>glance()</code> auf. Die Ergebnisse binden wir zeilenweise zusammen. Wie genau <code>rbind()</code> funktioniert, wird im Kapitel <code>Extras</code> erklärt.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rbind</span>(
  <span class="kw">glance</span>(model1),
  <span class="kw">glance</span>(model2),
  <span class="kw">glance</span>(model3)
)</code></pre></div>
<pre><code>## # A tibble: 3 x 11
##   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
## *     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   0.00486     -0.000164 0.347     0.967  0.327      2  -70.9  148.  158.
## 2   0.0163       0.00630  0.345     1.63   0.198      3  -69.7  147.  161.
## 3   0.0364       0.0216   0.343     2.47   0.0634     4  -67.7  145.  162.
## # ... with 2 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;</code></pre>
</div>
</div>
<div id="p-wert-korrektur" class="section level2">
<h2 class="hasAnchor">
<a href="#p-wert-korrektur" class="anchor"></a>p-Wert Korrektur</h2>
<p>Für eine p-Wert Korrektur können wir schlichtweg eine neue Spalte an den Ergebnisoutput mit <code><a href="http://www.rdocumentation.org/packages/ggpubr/topics/reexports">mutate()</a></code> hängen. Die korrigierten p-Werte erhalten wir dabei durch <code>p.adjust()</code>. Die verschiedenen Korrekturverfahren sind beispielsweise Holm, Benjamini-Hochberg oder Bonferroni. Exemplarisch gehen wir von Interaktionen von allen unabhängigen Variablen aus, um mehr p-Werte zum Vergleichen zu erhalten.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(Extraversion <span class="op">~</span><span class="st"> </span>Neurotizismus <span class="op">*</span><span class="st"> </span>Geschlecht <span class="op">*</span><span class="st"> </span>Offenheit, <span class="dt">data =</span> big_five) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggpubr/topics/reexports">mutate</a></span>(<span class="dt">p_adjusted =</span> <span class="kw">p.adjust</span>(p.value, <span class="dt">method =</span> <span class="st">"BH"</span>))</code></pre></div>
<pre><code>## # A tibble: 8 x 6
##   term                     estimate std.error statistic p.value p_adjusted
##   &lt;chr&gt;                       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
## 1 (Intercept)                5.48       1.56     3.50   5.72e-4    0.00457
## 2 Neurotizismus             -0.495      0.454   -1.09   2.77e-1    0.554  
## 3 Geschlechtm               -0.882      2.31    -0.381  7.03e-1    0.970  
## 4 Offenheit                 -0.744      0.466   -1.60   1.12e-1    0.448  
## 5 Neurotizismus:Geschlech~   0.0272     0.719    0.0378 9.70e-1    0.970  
## 6 Neurotizismus:Offenheit    0.153      0.135    1.14   2.56e-1    0.554  
## 7 Geschlechtm:Offenheit      0.215      0.689    0.312  7.55e-1    0.970  
## 8 Neurotizismus:Geschlech~   0.0149     0.213    0.0696 9.45e-1    0.970</code></pre>
</div>
<div id="exkurs-faktoren" class="section level2">
<h2 class="hasAnchor">
<a href="#exkurs-faktoren" class="anchor"></a>Exkurs: Faktoren</h2>
<p>Für Varianzanalysen müssen wir einen bisher nicht erwähnten neuen Datentyp einführen - den Faktor. Faktoren sind Characters mit festgelegten Ausprägungsgraden. Wir schauen uns an dieser Stelle nur an, wie man Faktoren erstellen kann. Dabei greifen wir auf Funktionen aus dem Kapitel der Datenvorbereitung zu. Der Datensatz für die Varianzanalysen hat die Variablen <code>iq</code>, <code>kreativitaet</code>, <code>zeitpunkt</code>, <code>gruppe</code> und <code>person_id</code>.</p>
<pre><code>## # A tibble: 90 x 5
##       iq kreativitaet zeitpunkt gruppe person_id
##    &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;      &lt;dbl&gt;
##  1  96.6         76.2 t1        A              1
##  2 104.          57.0 t1        B              2
##  3 117.          63.5 t1        C              3
##  4  91.9         18.6 t1        D              4
##  5 110.          73.6 t1        E              5
##  6 124.          55.5 t1        F              6
##  7  97.2         51.4 t1        A              7
##  8 104.          71.8 t1        B              8
##  9 119.          53.8 t1        C              9
## 10  92.9         42.3 t1        D             10
## # ... with 80 more rows</code></pre>
<p>Möchten wir nun aus der Gruppenspalte einen Faktor machen, geht dies mit <code>as.factor()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">repeated <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggpubr/topics/reexports">mutate</a></span>(<span class="dt">gruppe =</span> <span class="kw">as.factor</span>(gruppe))</code></pre></div>
<p>Angenommen Du möchtest alle Spalten mit Charactern in Faktoren umformatieren, geht das mit <code>mutate_if()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">repeated <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_if</span>(is.character, as.factor)</code></pre></div>
<p>Für mehrere Spalten verwendet man wie gewohnt <code>mutate_at()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">repeated <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(zeitpunkt, gruppe), as.factor)</code></pre></div>
<p>Mehr müssen wir auch gar nicht über Faktoren wissen. Ohne Faktoren können wir jedoch weder Kontraste einstellen noch den Tukey Post-Hoc Test berechnen; also am besten immer die unabhängigen Variablen bei Varianzanalysen in Faktoren umwandeln.</p>
</div>
<div id="varianzanalysen" class="section level2">
<h2 class="hasAnchor">
<a href="#varianzanalysen" class="anchor"></a>Varianzanalysen</h2>
<p>Vor jeder Varianzanalyse ohne Messwiederholung laden wir die drei Packages <code>car</code>, <code>sjstats</code> und <code>broom</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)
<span class="kw">library</span>(sjstats)
<span class="kw">library</span>(broom)</code></pre></div>
<p>Außerdem müssen wir die Kontraste diagonal einstellen, da wir ansonsten verzerrte Ergebnisse erhalten können. Dafür einfach den folgenden Befehl kopieren und in der Form ausführen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="st">"contr.sum"</span>, <span class="st">"poly.sum"</span>))</code></pre></div>
<div id="anova" class="section level3">
<h3 class="hasAnchor">
<a href="#anova" class="anchor"></a>ANOVA</h3>
<p>Die erste Zeile verändert sich syntaktisch nicht im Verlgeich zu Regressionmodellen. Nur der Befehl ändert sich zu <code>aov()</code>. In der zweiten Zeile rufen wir aus dem <code>car</code> Package die <code><a href="http://www.rdocumentation.org/packages/car/topics/Anova">Anova()</a></code> Funktion auf (beachte das großgeschriebene A), wordurch wir den Typ der Quadratsummen kontrollieren können. SPSS gibt zum Beispiel standardmäßig Typ 3 aus, R hingegen normalerweise Typ 1. Als letztes rufen wir aus dem <code>sjstats</code> Package die Funktion <code>anova_stats()</code> auf, um unter anderem direkt zusätzlich die Varianzerklärungen <span class="math inline">\(\eta^2\)</span> zu erhalten.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aov</span>(iq <span class="op">~</span><span class="st"> </span>zeitpunkt <span class="op">+</span><span class="st"> </span>gruppe, <span class="dt">data =</span> repeated) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/car/topics/Anova">Anova</a></span>(<span class="dt">type =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">anova_stats</span>() </code></pre></div>
<pre><code>##          term power      sumsq     meansq df statistic p.value etasq
## 1 (Intercept) 1.000 921619.274 921619.274  1  4741.995   0.000 0.980
## 2   zeitpunkt 0.231    400.918    200.459  2     1.031   0.361 0.000
## 3      gruppe 0.717   2094.995    418.999  5     2.156   0.067 0.002
## 4   Residuals    NA  15936.917    194.353 82        NA      NA    NA
##   partial.etasq omegasq partial.omegasq cohens.f
## 1         0.983   0.980           0.981    7.605
## 2         0.025   0.000           0.001    0.159
## 3         0.116   0.001           0.060    0.363
## 4            NA      NA              NA       NA</code></pre>
<div id="kontraste-einstellen" class="section level4">
<h4 class="hasAnchor">
<a href="#kontraste-einstellen" class="anchor"></a>Kontraste einstellen</h4>
<p>Schauen wir zuerst, wie die Kontraste für die Gruppenspalte aussehen. Innerhalb von <code>constrasts()</code> übergeben wir die gewünschte Spalte mit gewohnter Dollar-Syntax.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">contrasts</span>(repeated<span class="op">$</span>gruppe)</code></pre></div>
<pre><code>##   [,1] [,2] [,3] [,4] [,5]
## A    1    0    0    0    0
## B    0    1    0    0    0
## C    0    0    1    0    0
## D    0    0    0    1    0
## E    0    0    0    0    1
## F   -1   -1   -1   -1   -1</code></pre>
<p>Möchtest Du nun die Kontraste anpassen, kannst Du dies manuell machen. Hierfür verwenden wir erneut <code>rbind()</code>. Dabei wird zeilenweise unsere Matrix erstellt.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">contrasts</span>(repeated<span class="op">$</span>gruppe) &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>),
                                    <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
                                    <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),
                                    <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),
                                    <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),
                                    <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</code></pre></div>
</div>
<div id="messwiederholung" class="section level4">
<h4 class="hasAnchor">
<a href="#messwiederholung" class="anchor"></a>Messwiederholung</h4>
<p>Zur ANOVA mit Messwiederholung laden wir das Package <code>lmerTest</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lmerTest)</code></pre></div>
<p>Der Befehl zum Erstellen des Modells ändert sich zu <code><a href="http://www.rdocumentation.org/packages/lmerTest/topics/lmer">lmer()</a></code>. Ansonsten ist der einzige Unterschied das Kontrollieren der zufälligen Effekte – hier die zufällig schwankenden IQ-Ausprägungen zwischen den Personen. Wir kontrollieren dies mit <code>(1|person_id)</code>. Der Rest bleibt gleich.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/lmerTest/topics/lmer">lmer</a></span>(iq <span class="op">~</span><span class="st"> </span>zeitpunkt <span class="op">+</span><span class="st"> </span>gruppe <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>person_id), <span class="dt">data =</span> repeated) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/car/topics/Anova">Anova</a></span>(<span class="dt">type =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   term        statistic    df p.value
##   &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)   3899.       1  0     
## 2 zeitpunkt        2.88     2  0.237 
## 3 gruppe           9.47     5  0.0918</code></pre>
<p>Für die Effektstärke greifen wir erneut auf das <code>sjstats</code> Package zurück. Diesmal rufen wir die Funktion <code>r2()</code> auf.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/lmerTest/topics/lmer">lmer</a></span>(iq <span class="op">~</span><span class="st"> </span>zeitpunkt <span class="op">+</span><span class="st"> </span>gruppe <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>person_id), <span class="dt">data =</span> repeated) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">r2</span>()</code></pre></div>
<pre><code>## 
## R-Squared for Generalized Linear Mixed Model
## 
## Family : gaussian (identity)
## Formula: iq ~ zeitpunkt + gruppe + (1 | person_id)
## 
##    Marginal R2: 0.130
## Conditional R2: 0.320</code></pre>
</div>
</div>
<div id="manova" class="section level3">
<h3 class="hasAnchor">
<a href="#manova" class="anchor"></a>MANOVA</h3>
<p>Zum Rechnen multivariater Varianzanalysen wählen wir zuerst die abhängigen Variablen aus und konvertieren sie zu einer Matrix. Was es genau mit Matrizen auf sich hat, wird im Kapitel Extras erklärt.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AV &lt;-<span class="st"> </span>repeated <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(iq, kreativitaet) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.matrix</span>()</code></pre></div>
<p>Für MANOVAs benötigen wir wieder die <code>lm()</code> Funktion. Das hängt damit zusammen, dass unter jeder ANOVA eine Regression steckt und <code>aov()</code> nur eine spezielle Art ist, den <code>lm()</code> Befehl auszuführen. MANOVAs funktionieren nicht mit <code>aov()</code>! Außerdem ändert sich <code><a href="http://www.rdocumentation.org/packages/car/topics/Anova">Anova()</a></code> zu <code><a href="http://www.rdocumentation.org/packages/car/topics/Anova">Manova()</a></code> und wir können den Output nicht mit <code>tidy()</code> aufräumen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(AV <span class="op">~</span><span class="st"> </span>gruppe <span class="op">+</span><span class="st"> </span>zeitpunkt, <span class="dt">data =</span> repeated) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/car/topics/Anova">Manova</a></span>(<span class="dt">type =</span> <span class="dv">3</span>) </code></pre></div>
<pre><code>## 
## Type III MANOVA Tests: Pillai test statistic
##             Df test stat approx F num Df den Df Pr(&gt;F)    
## (Intercept)  1   0.98595  2841.28      2     81 &lt;2e-16 ***
## gruppe       5   0.15931     1.42     10    164 0.1757    
## zeitpunkt    2   0.03310     0.69      4    164 0.5999    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>Dabei steht <code>Pr(&gt;F)</code> für den p-Wert. Für Vergleiche innerhalb der jeweiligen abhängigen Variable, benutze <code>summary.aov()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(AV <span class="op">~</span><span class="st"> </span>gruppe <span class="op">+</span><span class="st"> </span>zeitpunkt, <span class="dt">data =</span> repeated) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summary.aov</span>() </code></pre></div>
<pre><code>##  Response iq :
##             Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## gruppe       5  2095.0  419.00  2.1559 0.06693 .
## zeitpunkt    2   400.9  200.46  1.0314 0.36108  
## Residuals   82 15936.9  194.35                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
##  Response kreativitaet :
##             Df  Sum Sq Mean Sq F value Pr(&gt;F)
## gruppe       5  1167.0  233.40  0.7401 0.5956
## zeitpunkt    2   184.7   92.33  0.2928 0.7470
## Residuals   82 25860.2  315.37</code></pre>
</div>
<div id="kruskal-wallis-test" class="section level3">
<h3 class="hasAnchor">
<a href="#kruskal-wallis-test" class="anchor"></a>Kruskal-Wallis Test</h3>
<p>Beim nicht-parametrischen Kruskall-Willis Test verändert sich syntaktisch nichts im Vergleich zu Regressionsmodellen und Varianzanalysen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kruskal.test</span>(iq <span class="op">~</span><span class="st"> </span>gruppe, <span class="dt">data =</span> repeated) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   statistic p.value parameter method                      
##       &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;                       
## 1      9.67  0.0853         5 Kruskal-Wallis rank sum test</code></pre>
</div>
</div>
<div id="post-hoc-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#post-hoc-tests" class="anchor"></a>Post-Hoc Tests</h2>
<p>Im folgenden seien zwei mögliche Post-Hoc Vergleiche vorgestellt.</p>
<div id="tukeyhsd" class="section level3">
<h3 class="hasAnchor">
<a href="#tukeyhsd" class="anchor"></a>TukeyHSD</h3>
<p>Für den Test von Tukey auf Honest Significant Differences (HSD) ändert sich nicht viel im Vergleich zur ANOVA. Nur wird nach der ANOVA die Funktion <code>TukeyHSD()</code> aufgerufen und dann der Output ins aufgeräumte Format gebracht.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aov</span>(iq <span class="op">~</span><span class="st"> </span>zeitpunkt <span class="op">*</span><span class="st"> </span>gruppe, <span class="dt">data =</span> repeated) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">TukeyHSD</span>() <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 171 x 6
##    term      comparison estimate conf.low conf.high adj.p.value
##    &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
##  1 zeitpunkt t2-t1        -5.15    -13.8       3.47       0.331
##  2 zeitpunkt t3-t1        -2.23    -10.9       6.39       0.810
##  3 zeitpunkt t3-t2         2.92     -5.70     11.5        0.697
##  4 gruppe    B-A           7.45     -7.47     22.4        0.689
##  5 gruppe    C-A           3.34    -11.6      18.3        0.986
##  6 gruppe    D-A          -2.54    -17.5      12.4        0.996
##  7 gruppe    E-A          11.4      -3.51     26.3        0.233
##  8 gruppe    F-A          -0.124   -15.0      14.8        1.000
##  9 gruppe    C-B          -4.11    -19.0      10.8        0.966
## 10 gruppe    D-B          -9.99    -24.9       4.93       0.375
## # ... with 161 more rows</code></pre>
</div>
<div id="post-hoc-t-tests" class="section level3">
<h3 class="hasAnchor">
<a href="#post-hoc-t-tests" class="anchor"></a>Post-Hoc-t-Tests</h3>
<p>Hier müssen wir erneut auf den Dollar Operator zurückgreifen. Als zusätzliches Argument kann man mit <code>p.adjust.method()</code> die Korrekturmethode festlegen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairwise.t.test</span>(repeated<span class="op">$</span>iq, repeated<span class="op">$</span>gruppe, 
                <span class="dt">p.adjust.method =</span>  <span class="st">"none"</span>) </code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  repeated$iq and repeated$gruppe 
## 
##   A      B      C      D      E     
## B 0.1472 -      -      -      -     
## C 0.5132 0.4224 -      -      -     
## D 0.6192 0.0531 0.2512 -      -     
## E 0.0277 0.4392 0.1171 0.0075 -     
## F 0.9807 0.1407 0.4978 0.6363 0.0261
## 
## P value adjustment method: none</code></pre>
</div>
</div>
<div id="korrelationskoeffizienten" class="section level2">
<h2 class="hasAnchor">
<a href="#korrelationskoeffizienten" class="anchor"></a>Korrelationskoeffizienten</h2>
<p>Es gibt einen Unterschied, ob man die Korrelation zwischen zwei Variablen berechnen (mit p-Wert) oder eine Korrelationstabelle mit allen Korrelation erhalten möchte.</p>
<div id="produkt-moment-korrelation-nach-pearson" class="section level3">
<h3 class="hasAnchor">
<a href="#produkt-moment-korrelation-nach-pearson" class="anchor"></a>Produkt-Moment Korrelation nach Pearson</h3>
<p>Die Standardeinstellung für <code>cor.test</code> ist die Produkt-Moment Korrelation nach Pearson. Die Argumente <code>method</code>, <code>alternative</code> und <code>conf.level</code> sind also optional.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(big_five<span class="op">$</span>Extraversion, big_five<span class="op">$</span>Neurotizismus, 
         <span class="dt">method =</span> <span class="st">"pearson"</span>,
         <span class="dt">alternative =</span> <span class="st">"two.sided"</span>,
         <span class="dt">conf.level =</span> .<span class="dv">95</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 1 x 8
##   estimate statistic p.value parameter conf.low conf.high method
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1   0.0697     0.984   0.327       198  -0.0697     0.206 Pears~
## # ... with 1 more variable: alternative &lt;chr&gt;</code></pre>
</div>
<div id="rangkorrelation-nach-spearman" class="section level3">
<h3 class="hasAnchor">
<a href="#rangkorrelation-nach-spearman" class="anchor"></a>Rangkorrelation nach Spearman</h3>
<p>Für die Rangkorrelation nach Spearman muss man lediglich das <code>method</code> Argument entsprechend anpassen (natürlich müssen die Variablen eigentlich ordinal sein).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(big_five<span class="op">$</span>Extraversion, big_five<span class="op">$</span>Neurotizismus, 
         <span class="dt">method =</span> <span class="st">"spearman"</span>,
         <span class="dt">alternative =</span> <span class="st">"two.sided"</span>,
         <span class="dt">conf.level =</span> .<span class="dv">95</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## Warning in cor.test.default(big_five$Extraversion,
## big_five$Neurotizismus, : Cannot compute exact p-value with ties</code></pre>
<pre><code>## # A tibble: 1 x 5
##   estimate statistic p.value method                          alternative
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                           &lt;chr&gt;      
## 1   0.0487  1268305.   0.493 Spearman's rank correlation rho two.sided</code></pre>
</div>
<div id="korrelationstabellen" class="section level3">
<h3 class="hasAnchor">
<a href="#korrelationstabellen" class="anchor"></a>Korrelationstabellen</h3>
<p>Nun kann es schon mal vorkommen, dass man mehr als zwei Variablen miteinander in einer Korrelationstabelle untersuchen möchte. Zuerst wählen wir im <code>repeated</code> Datensatz alle numerischen Spalten aus.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">repeated_num &lt;-<span class="st"> </span>repeated <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select_if</span>(is.numeric)</code></pre></div>
<p>Dann verwenden wir die Funktion <code>cor()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(repeated_num) </code></pre></div>
<pre><code>##                       iq kreativitaet   person_id
## iq            1.00000000   0.01162833 -0.15539732
## kreativitaet  0.01162833   1.00000000  0.03990274
## person_id    -0.15539732   0.03990274  1.00000000</code></pre>
</div>
</div>
<div id="kontingenztafeln" class="section level2">
<h2 class="hasAnchor">
<a href="#kontingenztafeln" class="anchor"></a>Kontingenztafeln</h2>
<p>Eine Kontigenztafel erstellt man einfach mit <code>table()</code>. Möchten wir zum Beispiel wissen, welches der Geschlechter häufiger eine starke Ausprägung von Extraversion mit über 3.5 haben, schreiben wir einfach</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(big_five<span class="op">$</span>Geschlecht, big_five<span class="op">$</span>Extraversion <span class="op">&gt;</span><span class="st"> </span><span class="fl">3.5</span>)</code></pre></div>
<pre><code>##    
##     FALSE TRUE
##   f   108   10
##   m    76    6</code></pre>
<p>Schauen wir uns nun an, wie man Kontigenztafeln analysiert. Angenommen wir haben vorherige Kontingenztafel als <code>tbl</code> gespeichert.</p>
<div id="fisher-exact-test" class="section level3">
<h3 class="hasAnchor">
<a href="#fisher-exact-test" class="anchor"></a>Fisher-exact Test</h3>
<p>Für den Fisher-Exact Test für <span class="math inline">\(2\times2\)</span> Kontigenztafeln, müssen wir nun lediglich unsere Kontingenztafel <code>tbl</code> der Funktion <code>fisher.test()</code> übergeben. Auch hier bereinigen wir den Output mit <code>tidy()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fisher.test</span>(tbl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>## # A tibble: 1 x 6
##   estimate p.value conf.low conf.high method                   alternative
##      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                    &lt;chr&gt;      
## 1    0.853   1.000    0.244      2.72 Fisher's Exact Test for~ two.sided</code></pre>
<p>Die Spalte <code>estimate</code> im Output ist in dem Fall die Odds ratio.</p>
</div>
<div id="mcnemars-chi2-test" class="section level3">
<h3 class="hasAnchor">
<a href="#mcnemars-chi2-test" class="anchor"></a>Mcnemars <span class="math inline">\(\chi^2\)</span> Test</h3>
<p>Das gleiche gilt für den Mcenamr Test. Hier sparen wir uns <code>tidy()</code>, weil der Output ohnehin bereits schön aufgeräumt aussieht.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcnemar.test</span>(tbl) </code></pre></div>
<pre><code>## 
##  McNemar's Chi-squared test with continuity correction
## 
## data:  tbl
## McNemar's chi-squared = 49.128, df = 1, p-value = 2.398e-12</code></pre>
</div>
<div id="pearsons-chi2-test" class="section level3">
<h3 class="hasAnchor">
<a href="#pearsons-chi2-test" class="anchor"></a>Pearsons <span class="math inline">\(\chi^2\)</span> Test</h3>
<p>Und auch beim asymptotischen <span class="math inline">\(\chi^2\)</span>-Test nach Pearson läuft es nach dem selben Schema ab.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(tbl)</code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  tbl
## X-squared = 0.001011, df = 1, p-value = 0.9746</code></pre>
</div>
</div>
</div>
<div id="explorative-faktorenanalyse" class="section level1">
<h1 class="hasAnchor">
<a href="#explorative-faktorenanalyse" class="anchor"></a>Explorative Faktorenanalyse</h1>
<p>Kommen wir nun zum letzten Thema – der explorativen Faktorenanalyse. Dabei betrachten wir zwei Verfahren: die Principal Component Analysis (PCA) und die Maximum Likelihood Faktorenanalyse (EFA). Zuerst wählen wir alle numerischen Spalten aus dem <code>big_five</code> Datensatz aus (alle anderen sind unbrauchbar).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num_data &lt;-<span class="st"> </span>big_five <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select_if</span>(is.numeric)</code></pre></div>
<div id="naive-hauptkomponentenanalyse" class="section level2">
<h2 class="hasAnchor">
<a href="#naive-hauptkomponentenanalyse" class="anchor"></a>Naive Hauptkomponentenanalyse</h2>
<p>Für die naive Hauptkomponentenanalyse (PCA) muss man keine Annahmen über die Faktorenanzahl treffen. Das einzige Argument, was man der Funktion <code>princomp()</code> übergeben muss, ist der Datensatz.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw">princomp</span>(num_data)</code></pre></div>
<p>Die Ladungen der Faktoren auf die Komponenten erhalten wir mit <code>loadings()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">loadings</span>(fit)</code></pre></div>
<pre><code>## 
## Loadings:
##                    Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6
## Alter               1.000                                   
## Extraversion                     -0.609  0.300         0.726
## Neurotizismus              0.980  0.150  0.127              
## Vertraeglichkeit                 -0.673        -0.502 -0.535
## Gewissenhaftigkeit         0.153 -0.391 -0.509  0.719 -0.218
## Offenheit                               -0.794 -0.472  0.373
## 
##                Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6
## SS loadings     1.000  1.000  1.000  1.000  1.000  1.000
## Proportion Var  0.167  0.167  0.167  0.167  0.167  0.167
## Cumulative Var  0.167  0.333  0.500  0.667  0.833  1.000</code></pre>
</div>
<div id="maximum-likelihood-faktorenanalyse" class="section level2">
<h2 class="hasAnchor">
<a href="#maximum-likelihood-faktorenanalyse" class="anchor"></a>Maximum Likelihood Faktorenanalyse</h2>
<p>Bei einer EFA muss man die Faktorenanzahl und die Rotationsart festlegen. Bei 5 erwarteten Faktoren und einer orthogonalen Rotation erhält man die Faktorenanalyse mit <code>factanal()</code> wie folgt</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fac &lt;-<span class="st"> </span><span class="kw">factanal</span>(num_data, <span class="dt">factors =</span> <span class="dv">2</span>, <span class="dt">rotation =</span> <span class="st">"varimax"</span>)</code></pre></div>
<p>Möchte man im Output übersichtlich nur Werte mit 2 Nachkommastellen in absteigender Form mit Werten größer 0.3, benutzt man <code>print()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fac <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">print</span>(<span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">cutoff =</span> <span class="fl">0.3</span>, <span class="dt">sort =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
## Call:
## factanal(x = num_data, factors = 2, rotation = "varimax")
## 
## Uniquenesses:
##              Alter       Extraversion      Neurotizismus 
##               0.96               0.00               0.91 
##   Vertraeglichkeit Gewissenhaftigkeit          Offenheit 
##               0.77               0.76               0.76 
## 
## Loadings:
##                    Factor1 Factor2
## Extraversion        0.97          
## Alter                             
## Neurotizismus                     
## Vertraeglichkeit    0.46          
## Gewissenhaftigkeit  0.30    0.39  
## Offenheit                   0.49  
## 
##                Factor1 Factor2
## SS loadings       1.26    0.58
## Proportion Var    0.21    0.10
## Cumulative Var    0.21    0.31
## 
## Test of the hypothesis that 2 factors are sufficient.
## The chi square statistic is 5.13 on 4 degrees of freedom.
## The p-value is 0.274</code></pre>
<p>Möchte man mit den Ergebnissen weiterrechen, kann man auch hier wieder <code>tidy()</code> verwenden.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fac <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>() </code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   variable           uniqueness     fl1    fl2
## * &lt;chr&gt;                   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1 Alter                   0.960 -0.0281  0.199
## 2 Extraversion            0.005  0.970  -0.234
## 3 Neurotizismus           0.912  0.136   0.264
## 4 Vertraeglichkeit        0.766  0.457   0.157
## 5 Gewissenhaftigkeit      0.755  0.300   0.393
## 6 Offenheit               0.763 -0.0217  0.486</code></pre>
<p>Das Kaiser-Maier-Olkin Kriterium erhält mit man mit der <code>KMO()</code> Funktion aus dem <code>psych</code> Package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">KMO</span>(num_data)</code></pre></div>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = num_data)
## Overall MSA =  0.51
## MSA for each item = 
##              Alter       Extraversion      Neurotizismus 
##               0.43               0.48               0.61 
##   Vertraeglichkeit Gewissenhaftigkeit          Offenheit 
##               0.52               0.60               0.45</code></pre>
</div>
<div id="scree-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#scree-plot" class="anchor"></a>Scree Plot</h2>
<p>Den Scree Plot erhalten wir nach Laden von <code>rBasics</code> mit <code><a href="../reference/scree_plot.html">scree_plot()</a></code>. Dabei gibt die Funktion einen ggplot zurück.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/scree_plot.html">scree_plot</a></span>(num_data)</code></pre></div>
<p><img src="05_Inferenzstatistik_files/figure-html/unnamed-chunk-66-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Wir erinnern uns, alle Graphen aus dem Package <code>ggpubr</code> (siehe Kapitel Visualisierungen) basieren auf <code>ggplot2</code>. Das heißt, wir können den Graphen ganz normal mit <code><a href="http://www.rdocumentation.org/packages/ggpubr/topics/ggpar">ggpar()</a></code> anpassen. Angenommen wir hätten den Graphen als <code>plot</code> gespeichert, könnten wir die Parameter einfach anpassen mit</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggpubr/topics/ggpar">ggpar</a></span>(plot, 
      <span class="dt">font.x =</span> <span class="dv">14</span>, 
      <span class="dt">font.y =</span> <span class="dv">14</span>, 
      <span class="dt">font.tickslab =</span> <span class="dv">14</span>,
      <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.4</span>, <span class="fl">1.6</span>))</code></pre></div>
<p><img src="05_Inferenzstatistik_files/figure-html/unnamed-chunk-68-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#einfuhrung">Einführung</a></li>
      <li><a href="#stichprobenplanung-und-power">Stichprobenplanung und Power</a></li>
      <li><a href="#exkurs-dollar-operator">Exkurs: Dollar-Operator</a></li>
      <li>
<a href="#voraussetzungen-prufen">Voraussetzungen prüfen</a><ul class="nav nav-pills nav-stacked">
<li><a href="#normalverteilung">Normalverteilung</a></li>
      <li><a href="#varianzhomogenitat">Varianzhomogenität</a></li>
      </ul>
</li>
      <li>
<a href="#testen">Testen</a><ul class="nav nav-pills nav-stacked">
<li><a href="#mittelwertsvergleich">Mittelwertsvergleich</a></li>
      <li><a href="#regressionsanalysen">Regressionsanalysen</a></li>
      <li><a href="#p-wert-korrektur">p-Wert Korrektur</a></li>
      <li><a href="#exkurs-faktoren">Exkurs: Faktoren</a></li>
      <li><a href="#varianzanalysen">Varianzanalysen</a></li>
      <li><a href="#post-hoc-tests">Post-Hoc Tests</a></li>
      <li><a href="#korrelationskoeffizienten">Korrelationskoeffizienten</a></li>
      <li><a href="#kontingenztafeln">Kontingenztafeln</a></li>
      </ul>
</li>
      <li>
<a href="#explorative-faktorenanalyse">Explorative Faktorenanalyse</a><ul class="nav nav-pills nav-stacked">
<li><a href="#naive-hauptkomponentenanalyse">Naive Hauptkomponentenanalyse</a></li>
      <li><a href="#maximum-likelihood-faktorenanalyse">Maximum Likelihood Faktorenanalyse</a></li>
      <li><a href="#scree-plot">Scree Plot</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jan Philipp Nolte.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
