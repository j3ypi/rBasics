<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inferenzstatistik • rBasics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Inferenzstatistik">
<meta property="og:description" content="rBasics">
<meta property="og:image" content="https://github.com/j3ypi/rBasics/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-142129809-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-142129809-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rBasics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_Setup.html">Setup</a>
    </li>
    <li>
      <a href="../articles/02_Datenvorbereitung.html">Datenvorbereitung</a>
    </li>
    <li>
      <a href="../articles/03_Deskriptive_Statistik.html">Deskriptive Statistik</a>
    </li>
    <li>
      <a href="../articles/04_Visualisierungen.html">Visualisierungen</a>
    </li>
    <li>
      <a href="../articles/05_Inferenzstatistik.html">Inferenzstatistik</a>
    </li>
    <li>
      <a href="../articles/06_Extras.html">Extras</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    PDFs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../pdfs/01_Setup.pdf">Setup</a>
    </li>
    <li>
      <a href="../pdfs/02_Datenvorbereitung.pdf">Datenvorbereitung</a>
    </li>
    <li>
      <a href="../pdfs/03_Deskriptive_Statistik.pdf">Deskriptive Statistik</a>
    </li>
    <li>
      <a href="../pdfs/04_Visualisierungen.pdf">Visualisierungen</a>
    </li>
    <li>
      <a href="../pdfs/05_Inferenzstatistik.pdf">Inferenzstatistik</a>
    </li>
    <li>
      <a href="../pdfs/06_Extras.pdf">Extras</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Dokumentation</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/j3ypi/rBasics">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Inferenzstatistik</h1>
            <h3 data-toc-skip class="subtitle">R für empirische
Wissenschaften v1.0.2</h3>
                        <h4 data-toc-skip class="author">Jan Philipp
Nolte</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/j3ypi/rBasics/blob/HEAD/vignettes/05_Inferenzstatistik.Rmd"><code>vignettes/05_Inferenzstatistik.Rmd</code></a></small>
      <div class="hidden name"><code>05_Inferenzstatistik.Rmd</code></div>

    </div>

    
    
<div style="page-break-after: always;"></div>
<div class="info">
Die neue Version befindet sich als Buch unter
<a href="https://r-empirische-wissenschaften.de" class="external-link">
https://r-empirische-wissenschaften.de </a>
</div>
<div class="section level2">
<h2 id="einführung">Einführung<a class="anchor" aria-label="anchor" href="#einf%C3%BChrung"></a>
</h2>
<p>Viele inferenzstatistische Verfahren sind direkt in R integriert. Ein
paar Verfahren müssen wir jedoch mit externen Packages rechnen. Leider
ist weder in <code>Base R</code> noch in den Packages eine wirklich
konsistente, Pipe-freundliche Syntax gegeben. Außerdem sind die Outputs
unbearbeitet nicht übersichtlich lesbar. Im Folgenden schauen wir uns
diverse statistische Verfahren an und lassen uns die Ergebnisse in
schöner Form mit Funktionen des <code>broom</code> (engl. für Besen)
Packages wiedergeben. Aber dazu später mehr. Das Ziel dieses Kapitel ist
das Vorstellen der Funktionen mit ihren Argumenten. Es dient mehr als
Komprehendium zum Nachschlagen, allerdings sollte man den grundlegenden
Workflow verstanden und sich vor allem den Exkurs zu <a href="#exkurs-dollar-operator">Dollar-Operatoren</a> angeschaut haben.
Bevor wir in die Inferenzstatistik eintauchen, schauen wir uns zuerst
die Stichprobenplanung und Power-Berechnung an.</p>
</div>
<div class="section level2">
<h2 id="stichprobenplanung-und-power">Stichprobenplanung und Power<a class="anchor" aria-label="anchor" href="#stichprobenplanung-und-power"></a>
</h2>
<p>Sowohl für die Stichprobenplanung als auch für die Power-Berechenung
benötigen wir das Package <code>pwr</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr" class="external-link">pwr</a></span><span class="op">)</span></span></code></pre></div>
<p>Möchten wir nun zum Beispiel die optimale Stichprobengröße für eine
ANOVA mit zwei Gruppen <code>k</code>, einer erwarteten Effektstärke
<code>f</code> von .3 und einem <span class="math inline">\(\alpha\)</span>-Niveau von 5% bei einer Power von
0.8 erhalten, benutzen wir <code><a href="https://rdrr.io/pkg/pwr/man/pwr.anova.test.html" class="external-link">pwr.anova.test()</a></code> und setzen
ein.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.anova.test.html" class="external-link">pwr.anova.test</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span>,  </span>
<span>               f <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>               sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>               power <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##      Balanced one-way analysis of variance power calculation </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##               k = 2</span></span>
<span><span class="co">##               n = 44.58577</span></span>
<span><span class="co">##               f = 0.3</span></span>
<span><span class="co">##       sig.level = 0.05</span></span>
<span><span class="co">##           power = 0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## NOTE: n is number in each group</span></span></code></pre>
<p>Für andere Verfahren gibt es nach dem gleichen Schema entsprechende
Funktionen (beispielsweise <code><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html" class="external-link">pwr.t.test()</a></code>). Wenn man Post-Hoc
die Power ausrechnen möchte, verwendet man die selbe Funktion. Anstelle
des power Arguments schreiben wir aber diesmal die beobachtete
Stichprobengrösse <code>n</code> als Argument in die Funktion. Beachte,
dass <code>f</code> auch hier die erwartete und nicht die beobachtete
Effektstärke ist!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.anova.test.html" class="external-link">pwr.anova.test</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span>,  </span>
<span>               n <span class="op">=</span> <span class="fl">30</span>, </span>
<span>               f <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>               sig.level <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##      Balanced one-way analysis of variance power calculation </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##               k = 2</span></span>
<span><span class="co">##               n = 30</span></span>
<span><span class="co">##               f = 0.3</span></span>
<span><span class="co">##       sig.level = 0.05</span></span>
<span><span class="co">##           power = 0.6275046</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## NOTE: n is number in each group</span></span></code></pre>
<p>Falls die Stichprobenplanung für den gewünschten Test nicht in
<code>pwr</code> implementiert ist, sei an dieser Stelle auf <a href="http://gpower.hhu.de/" class="external-link">g*Power</a> verwiesen.</p>
</div>
<div class="section level2">
<h2 id="exkurs-dollar-operator">Exkurs: Dollar-Operator<a class="anchor" aria-label="anchor" href="#exkurs-dollar-operator"></a>
</h2>
<p>Während der Inferenzstatistik lässt es sich leider nicht vermeiden,
ab und an das Dollarzeichen zu verwenden, um eine Spalte des Datensatzes
auszuwählen. Warum geht es hier nicht einfach zuvor mit
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code>? Schauen wir uns mal genauer an, was die beiden
Befehle jeweils zurückgeben.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tipp_wm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Person</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 384 × 1</span></span></span>
<span><span class="co">##    Person      </span></span>
<span><span class="co">##    <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>       </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span><span> Thomas_Bayes</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with 374 more rows</span></span></span></code></pre>
<p>Während <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> einen tibble mit der ausgewählten
Spalte zurückgibt, erhält man durch den Dollar-Operator einen Vektor.
Was genau Vektoren ausmachen, ist an dieser Stelle nicht weiter wichtig
und wird deshalb unter Extras erläutert. Um die Spalte ausgeben zu
lassen, hat man immer das selbe Schema:
<code>datensatzName$spaltenName</code>. Wollen wir aus dem Datensatz
<code>tipp_wm</code> die Spalte Person herausziehen, schreiben wir
einfach</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tipp_wm</span><span class="op">$</span><span class="va">Person</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes"</span></span>
<span><span class="co">##  [6] "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes" "Thomas_Bayes"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="voraussetzungen-prüfen">Voraussetzungen prüfen<a class="anchor" aria-label="anchor" href="#voraussetzungen-pr%C3%BCfen"></a>
</h2>
<p>Um zu entscheiden, welchen Test wir verwenden dürfen, müssen wir erst
die Voraussetzungen prüfen.</p>
<div class="section level3">
<h3 id="normalverteilung">Normalverteilung<a class="anchor" aria-label="anchor" href="#normalverteilung"></a>
</h3>
<p>Am besten prüft man die Normalverteilung rein graphisch mit Q-Q
Plots.</p>
<div class="section level4">
<h4 id="q-q-plot">Q-Q Plot<a class="anchor" aria-label="anchor" href="#q-q-plot"></a>
</h4>
<p>Dafür verwenden wir erneut das Package <code>ggpubr</code> (siehe
Kapitel Visualisierungen).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span></code></pre></div>
<p>Als erstes Argument übergeben wir den Namen des Datensatzes. In
Anführungszeichen schreiben wir als zweites Argument die zu überprüfende
Spalte.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggqqplot.html" class="external-link">ggqqplot</a></span><span class="op">(</span><span class="va">big_five</span>, <span class="st">"Extraversion"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">sample</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span><span> This can happen when ggplot fails to infer the correct grouping structure in</span></span></span>
<span><span class="co">##   the data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span><span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span></span>
<span><span class="co">##   variable into a factor?</span></span>
<span><span class="co">## The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">sample</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span><span> This can happen when ggplot fails to infer the correct grouping structure in</span></span></span>
<span><span class="co">##   the data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span><span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span></span>
<span><span class="co">##   variable into a factor?</span></span></code></pre>
<p><img src="05_Inferenzstatistik_files/figure-html/unnamed-chunk-8-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="shapiro-wilks-test">Shapiro-Wilks Test<a class="anchor" aria-label="anchor" href="#shapiro-wilks-test"></a>
</h4>
<p>Alternativ kann auch der Shapiro-Wilks Test verwendet werden. Hier
verwenden wir zum ersten mal die Dollar-Syntax. Der Funktion übergeben
wir die Spalte <code>Extraversion</code> aus dem Datensatz
<code>big_five</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  big_five$Extraversion</span></span>
<span><span class="co">## W = 0.95715, p-value = 9.845e-06</span></span></code></pre>
<p>Nun sieht der p-Wert etwas seltsam aus. Bei SPSS und Stata wird unter
.001 nur noch &lt;.001 angezeigt. In <code>base R</code> hingegen wird
bis 2e-16, also <span class="math inline">\(2 \times 10^{-16}\)</span>
(0.0000000000000002) differenziert. Mit dem <code>broom</code> Package
gibt es keine Untergrenze.</p>
</div>
<div class="section level4">
<h4 id="kolgomorov-smirnov-test">Kolgomorov-Smirnov Test<a class="anchor" aria-label="anchor" href="#kolgomorov-smirnov-test"></a>
</h4>
<p>Die zu überprüfende Spalte wird genau wie beim Shapiro Wilks Test
übergeben. Zusätzlich muss noch <code>rnorm</code> in Anführungszeichen
zum Testen auf Normalverteilung übergeben werden.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html" class="external-link">ks.test</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span>, <span class="st">"rnorm"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  big_five$Extraversion</span></span>
<span><span class="co">## D = 3.2167, p-value &lt; 2.2e-16</span></span>
<span><span class="co">## alternative hypothesis: two-sided</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="varianzhomogenität">Varianzhomogenität<a class="anchor" aria-label="anchor" href="#varianzhomogenit%C3%A4t"></a>
</h3>
<p>Auch beim Testen der Varianzhomogenität gibt es drei bekannte
Verfahren. Ab hier werden wir versuchen, ein konsistentes Schema zum
Testen zu entwickeln.</p>
<div class="section level4">
<h4 id="f-test">F-Test<a class="anchor" aria-label="anchor" href="#f-test"></a>
</h4>
<p>Zuerst rufen wir den F-Test mit <code><a href="https://rdrr.io/r/stats/var.test.html" class="external-link">var.test()</a></code> auf.
Angenommen wir möchten Extraversion zwischen den Geschlechtern auf
Varianzhomogenität prüfen. Getrennt werden die Variablen durch eine
sogenannte Tilde (~). Diese Schreibweise ist zwingend notwendig, wenn
man als zweite Spalte eine kategorisierende Spalte wie Geschlecht (zwei
Ausprägungsgrade) der Funktion übergibt. Um schön formatierte Ergebnisse
zu erhalten, rufen wir zuletzt <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> auf, welches eine
Funktion aus dem bereits erwähnten <code>broom</code> Package ist, auf
das wir ständig zurückgreifen werden. Zuerst müssen wir also das Package
laden. Da wir wieder die Pipe verwenden, müssen wir selbstverständlich
auch das <code>tidyverse</code> wieder laden.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<p>Nun können wir den F-Test rechnen.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/var.test.html" class="external-link">var.test</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Geschlecht</span>, data <span class="op">=</span> <span class="va">big_five</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Multiple parameters; naming those columns num.df, den.df</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">##   estimate num.df den.df statistic p.value conf.low conf.high method     alter…¹</span></span>
<span><span class="co">##      <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>      </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>     1.19    117     81      1.19   0.413    0.787      1.76 F test to… two.si…</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable name ¹​alternative</span></span></span></code></pre>
<p>Die Spalte <code>statistic</code> enthält die jeweilige Teststatistik
– in dem Fall den F-Wert. Man kann den F-Test mit
<code>alternative</code> für einseitig oder zweiseitige Tests und mit
<code>conf.level</code> das <span class="math inline">\(\alpha\)</span>
Niveau anpassen. Nun wollen wir die Varianzhomogenität zwischen
<code>Extraversion</code> und <code>Neurotizismus</code> überprüfen.
Exemplarisch seien hier die veränderbaren zusätzlichen Argumente mit
aufgelistet. Dies ist allerdings für Dich nur notwendig, wenn Du die
Argumente verändern möchtest. Weil die zweite Variable keine
kategorisierende ist, müssen wir wieder auf die Dollar-Syntax
zurückgreifen (<code>datenName$spaltenName</code>)</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/var.test.html" class="external-link">var.test</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span>, <span class="va">big_five</span><span class="op">$</span><span class="va">Neurotizismus</span>,</span>
<span>         alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>         conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Multiple parameters; naming those columns num.df, den.df</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">##   estimate num.df den.df statistic  p.value conf.low conf.high method    alter…¹</span></span>
<span><span class="co">##      <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>    0.258    199    199     0.258 3.55</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-20</span><span>    0.196     0.342 F test t… two.si…</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable name ¹​alternative</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="bartletts-test">Bartletts Test<a class="anchor" aria-label="anchor" href="#bartletts-test"></a>
</h4>
<p>Der Bartletts Test funktioniert wie der F-Test. Nur können hier keine
zusätzlichen Argumente übergeben werden.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">big_five</span><span class="op">$</span><span class="va">Geschlecht</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   statistic p.value parameter method                                   </span></span>
<span><span class="co">##       <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>                                    </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>     0.690   0.406         1 Bartlett test of homogeneity of variances</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="levene-test">Levene Test<a class="anchor" aria-label="anchor" href="#levene-test"></a>
</h4>
<p>Für den Levene Test benötigen wir mit <code>car</code> ein externes
Packages.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span></code></pre></div>
<p>Die Funktion ist leider nicht konsistent benannt, da der
Funktionsname von keinem Punkt getrennt und zusätzlich das zweite Wort
(Test) groß geschrieben wird. Also Achtung vor Tippfehlern! Ansonsten
funktioniert hier alles wie gewohnt.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html" class="external-link">leveneTest</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span>, <span class="va">big_five</span><span class="op">$</span><span class="va">Geschlecht</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in leveneTest.default(big_five$Extraversion, big_five$Geschlecht):</span></span>
<span><span class="co">## big_five$Geschlecht coerced to factor.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   statistic p.value    df df.residual</span></span>
<span><span class="co">##       <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span>       </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> 0.000</span><span style="text-decoration: underline;">092</span><span>5   0.992     1         198</span></span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="testen">Testen<a class="anchor" aria-label="anchor" href="#testen"></a>
</h2>
<p>Sind alle Voraussetzungen geprüft, geht es ans Testen.</p>
<div class="section level3">
<h3 id="mittelwertsvergleich">Mittelwertsvergleich<a class="anchor" aria-label="anchor" href="#mittelwertsvergleich"></a>
</h3>
<p>Zwischen abhängigen und unabhängigen t-Tests sowie zwischen t-Test
und Welch-Test besteht in R kaum ein syntaktischer Unterschied.</p>
<div class="section level4">
<h4 id="t-test">t-Test<a class="anchor" aria-label="anchor" href="#t-test"></a>
</h4>
<p>Schauen wir uns zuerst die grundlegende Funktion
<code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> an. Dabei ändert sich nichts im Vergleich zu den
vorherigen Tests auf Varianzhomogenität. Auch hier haben wir die
Unterteilung durch die Tilde (<code>~</code>), wenn die zweite Spalte
kategorisierend ist und die Dollar-Syntax bei zwei intervallskalierten
Variablen.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Geschlecht</span>, data <span class="op">=</span> <span class="va">big_five</span>,</span>
<span>       paired <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 10</span></span></span>
<span><span class="co">##   estim…¹ estim…² estim…³ stati…⁴ p.value param…⁵ conf.…⁶ conf.…⁷ method alter…⁸</span></span>
<span><span class="co">##     <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> -</span><span style="color: #BB0000;">0.063</span><span style="color: #BB0000;text-decoration: underline;">4</span><span>    3.05    3.11   -</span><span style="color: #BB0000;">1.27</span><span>   0.204     198  -</span><span style="color: #BB0000;">0.162</span><span>  0.034</span><span style="text-decoration: underline;">7</span><span> Two S… two.si…</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​estimate, ²​estimate1, ³​estimate2,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁴​statistic, ⁵​parameter, ⁶​conf.low, ⁷​conf.high, ⁸​alternative</span></span></span></code></pre>
<p>Die Argumente <code>alternative</code> und <code>conf.level</code>
können auch hier geändert werden. Entscheidend für einen abhängigen oder
unabhängigen t-Test ist jedoch das <code>paired</code> Argument. Setze
es auf <code>TRUE</code> für abhängige und auf <code>FALSE</code> für
unabhängige Stichproben. Das Argument <code>var.equal</code> besagt,
dass wir von Varianzhomogenität ausgehen (also einen t-test machen).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span>, <span class="va">big_five</span><span class="op">$</span><span class="va">Neurotizismus</span>,</span>
<span>       alternative <span class="op">=</span> <span class="st">"two.sided"</span>, </span>
<span>       conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>       paired <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 10</span></span></span>
<span><span class="co">##   estim…¹ estim…² estim…³ stati…⁴ p.value param…⁵ conf.…⁶ conf.…⁷ method alter…⁸</span></span>
<span><span class="co">##     <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> -</span><span style="color: #BB0000;">0.057</span><span style="color: #BB0000;text-decoration: underline;">0</span><span>    3.08    3.13   -</span><span style="color: #BB0000;">1.05</span><span>   0.292     398  -</span><span style="color: #BB0000;">0.163</span><span>  0.049</span><span style="text-decoration: underline;">3</span><span> Two S… two.si…</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​estimate, ²​estimate1, ³​estimate2,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁴​statistic, ⁵​parameter, ⁶​conf.low, ⁷​conf.high, ⁸​alternative</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="welch-test">Welch-Test<a class="anchor" aria-label="anchor" href="#welch-test"></a>
</h4>
<p>Bei heterogenen Varianzen muss man zum Verwenden des
nicht-parametrischen Welch-Tests lediglich das <code>var.equal</code>
Argument auf <code>FALSE</code> setzen.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span>, <span class="va">big_five</span><span class="op">$</span><span class="va">Neurotizismus</span>,</span>
<span>       alternative <span class="op">=</span> <span class="st">"two.sided"</span>, </span>
<span>       conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>       paired <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 10</span></span></span>
<span><span class="co">##   estim…¹ estim…² estim…³ stati…⁴ p.value param…⁵ conf.…⁶ conf.…⁷ method alter…⁸</span></span>
<span><span class="co">##     <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> -</span><span style="color: #BB0000;">0.057</span><span style="color: #BB0000;text-decoration: underline;">0</span><span>    3.08    3.13   -</span><span style="color: #BB0000;">1.05</span><span>   0.293    295.  -</span><span style="color: #BB0000;">0.163</span><span>  0.049</span><span style="text-decoration: underline;">4</span><span> Welch… two.si…</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​estimate, ²​estimate1, ³​estimate2,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁴​statistic, ⁵​parameter, ⁶​conf.low, ⁷​conf.high, ⁸​alternative</span></span></span></code></pre>
<p>In der <code>method</code> Spalte im Output steht nun auch
<code>Welch</code>.</p>
</div>
<div class="section level4">
<h4 id="cohensd">Cohens’d<a class="anchor" aria-label="anchor" href="#cohensd"></a>
</h4>
<p>Für die Effektstärke nach Cohen laden wir das Package
<code>effsize</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mtorchiano/effsize/" class="external-link">effsize</a></span><span class="op">)</span></span></code></pre></div>
<p>Auch hier kommt die Dollar-Syntax zum Einsatz.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/effsize/man/cohen.d.html" class="external-link">cohen.d</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span>, <span class="va">big_five</span><span class="op">$</span><span class="va">Neurotizismus</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Cohen's d</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## d estimate: -0.1054057 (negligible)</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##       lower       upper </span></span>
<span><span class="co">## -0.30213641  0.09132499</span></span></code></pre>
<p>In Klammern hinter der Effekstärke steht sogar direkt eine Einordnung
über die Größe.</p>
</div>
</div>
<div class="section level3">
<h3 id="regressionsanalysen">Regressionsanalysen<a class="anchor" aria-label="anchor" href="#regressionsanalysen"></a>
</h3>
<p>Auch bei Regressionsanalysen ändert sich nicht viel. Wichtig ist ab
jetzt nur, dass die abhängige Variable auf der linken Seite der Tilde
(<code>~</code>) steht und die unabhängigen Variablen auf der rechten
Seite. Der Befehl heißt <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, was für linear model
steht.</p>
<div class="section level4">
<h4 id="einfache-lineare-regression">Einfache Lineare Regression<a class="anchor" aria-label="anchor" href="#einfache-lineare-regression"></a>
</h4>
<p>Eine einfache lineare Regression erhalten wir noch nach genau dem
selben Schema wie zuvor.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Neurotizismus</span>, data <span class="op">=</span> <span class="va">big_five</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term          estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>            </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> (Intercept)     2.96      0.116     25.7   7.01</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-65</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span><span> Neurotizismus   0.035</span><span style="text-decoration: underline;">4</span><span>    0.036</span><span style="text-decoration: underline;">0</span><span>     0.984 3.27</span><span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="multiple-lineare-regression">Multiple Lineare Regression<a class="anchor" aria-label="anchor" href="#multiple-lineare-regression"></a>
</h4>
<p>Möchten wir jetzt mehrere unabhängige Variablen auf Einfluss prüfen,
müssen wir diese nur mit einem Pluszeichen hinzufügen.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Neurotizismus</span> <span class="op">+</span> <span class="va">Geschlecht</span>, data <span class="op">=</span> <span class="va">big_five</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">##   term          estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>            </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> (Intercept)     2.90      0.123      23.5  5.95</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-59</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span><span> Neurotizismus   0.046</span><span style="text-decoration: underline;">9</span><span>    0.036</span><span style="text-decoration: underline;">7</span><span>      1.28 2.03</span><span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span><span> Geschlechtm     0.076</span><span style="text-decoration: underline;">8</span><span>    0.050</span><span style="text-decoration: underline;">8</span><span>      1.51 1.32</span><span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span></code></pre>
<p>Wenn wir eine Interaktion zwischen Neurotizismus und Geschlecht
erwarten würden, müsste man nur das Pluszeichen durch ein
Multiplikationszeichen ersetzen.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Neurotizismus</span> <span class="op">*</span> <span class="va">Geschlecht</span>, data <span class="op">=</span> <span class="va">big_five</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   term                      estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>                        </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> (Intercept)                3.04       0.167    18.2    5.39</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-44</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span><span> Neurotizismus              0.003</span><span style="text-decoration: underline;">74</span><span>    0.050</span><span style="text-decoration: underline;">4</span><span>    0.074</span><span style="text-decoration: underline;">1</span><span> 9.41</span><span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span><span> Geschlechtm               -</span><span style="color: #BB0000;">0.207</span><span>      0.233    -</span><span style="color: #BB0000;">0.889</span><span>  3.75</span><span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span><span> Neurotizismus:Geschlechtm  0.091</span><span style="text-decoration: underline;">7</span><span>     0.073</span><span style="text-decoration: underline;">5</span><span>    1.25   2.14</span><span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span></code></pre>
<p>Denke daran, dass <span class="math inline">\(e-1\)</span> für <span class="math inline">\(\times 10^{-1}\)</span> steht. Der p-Wert zur
Interaktion wäre also <span class="math inline">\(0.214\)</span>.</p>
</div>
<div class="section level4">
<h4 id="informationskriterien-und-r2">Informationskriterien und <span class="math inline">\(R^2\)</span><a class="anchor" aria-label="anchor" href="#informationskriterien-und-r2"></a>
</h4>
<p>Natürlich interessiert uns nicht nur der p-Wert, sondern auch die
Effektstärke <span class="math inline">\(R^2\)</span> und die
Informationskriterien (AIC, BIC). Anstelle von <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>
schreiben wir dafür einfach <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Neurotizismus</span> <span class="op">*</span> <span class="va">Geschlecht</span>, data <span class="op">=</span> <span class="va">big_five</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 12</span></span></span>
<span><span class="co">##   r.squ…¹ adj.r…² sigma stati…³ p.value    df logLik   AIC   BIC devia…⁴ df.re…⁵</span></span>
<span><span class="co">##     <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>  0.024</span><span style="text-decoration: underline;">0</span><span> 0.009</span><span style="text-decoration: underline;">11</span><span> 0.345    1.61   0.188     3  -</span><span style="color: #BB0000;">68.9</span><span>  148.  164.    23.3     196</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with 1 more variable: nobs &lt;int&gt;, and abbreviated variable names</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ¹​r.squared, ²​adj.r.squared, ³​statistic, ⁴​deviance, ⁵​df.residual</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="logistische-regression">Logistische Regression<a class="anchor" aria-label="anchor" href="#logistische-regression"></a>
</h4>
<p>Für eine logistische Regression ändert sich der Befehl zu
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> (für Generalized linear model). Der Rest bleibt
gleich. Zum exemplarischen Rechnen, müssen wir erst das Geschlecht
numerisch kodieren.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">big_five_new</span> <span class="op">&lt;-</span> <span class="va">big_five</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Geschlecht <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">Geschlecht</span> <span class="op">==</span> <span class="st">"m"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Nun können wir wie gewohnt das Modell aufstellen.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Geschlecht</span> <span class="op">~</span> <span class="va">Neurotizismus</span>, data <span class="op">=</span> <span class="va">big_five_new</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   term          estimate std.error statistic     p.value</span></span>
<span><span class="co">##   <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>            </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>       </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> (Intercept)      0.878    0.161       5.44 0.000</span><span style="text-decoration: underline;">000</span><span>154</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span><span> Neurotizismus   -</span><span style="color: #BB0000;">0.149</span><span>    0.050</span><span style="text-decoration: underline;">3</span><span>     -</span><span style="color: #BB0000;">2.97</span><span> 0.003</span><span style="text-decoration: underline;">37</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="hierarchische-regression">Hierarchische Regression<a class="anchor" aria-label="anchor" href="#hierarchische-regression"></a>
</h4>
<p>Eine hierarchische Regression ist nichts anderes als das Vergleichen
verschiedener linearer Modelle unter Hinzufügen von Variablen. Wir
werden für eine größere Übersichtlichkeit die Modelle diesmal in
Variablen speichern. Beachte, dass wir hier kein <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>
aufrufen, da wir die Informationskriterien der linearen Modelle später
mit <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> vergleichen wollen.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Neurotizismus</span>, data <span class="op">=</span> <span class="va">big_five</span><span class="op">)</span> </span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Neurotizismus</span> <span class="op">+</span> <span class="va">Geschlecht</span>, data <span class="op">=</span> <span class="va">big_five</span><span class="op">)</span></span>
<span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Neurotizismus</span> <span class="op">+</span> <span class="va">Geschlecht</span> <span class="op">+</span> <span class="va">Offenheit</span>, data <span class="op">=</span> <span class="va">big_five</span><span class="op">)</span> </span></code></pre></div>
<p>Um die Modelle nun zu vergleichen, rufen wir drei mal
<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> auf. Die Ergebnisse binden wir zeilenweise
zusammen. Wie genau <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code> funktioniert, wird im Kapitel
<code>Extras</code> erklärt.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 12</span></span></span>
<span><span class="co">##   r.squared adj.r.squared sigma stati…¹ p.value    df logLik   AIC   BIC devia…²</span></span>
<span><span class="co">##       <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>         </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>   0.004</span><span style="text-decoration: underline;">86</span><span>     -</span><span style="color: #BB0000;">0.000</span><span style="color: #BB0000;text-decoration: underline;">164</span><span> 0.347   0.967  0.327      1  -</span><span style="color: #BB0000;">70.9</span><span>  148.  158.    23.8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span><span>   0.016</span><span style="text-decoration: underline;">3</span><span>       0.006</span><span style="text-decoration: underline;">30</span><span>  0.345   1.63   0.198      2  -</span><span style="color: #BB0000;">69.7</span><span>  147.  161.    23.5</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span><span>   0.036</span><span style="text-decoration: underline;">4</span><span>       0.021</span><span style="text-decoration: underline;">6</span><span>   0.343   2.47   0.063</span><span style="text-decoration: underline;">4</span><span>     3  -</span><span style="color: #BB0000;">67.7</span><span>  145.  162.    23.0</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with 2 more variables: df.residual &lt;int&gt;, nobs &lt;int&gt;, and abbreviated</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   variable names ¹​statistic, ²​deviance</span></span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="p-wert-korrektur">p-Wert Korrektur<a class="anchor" aria-label="anchor" href="#p-wert-korrektur"></a>
</h3>
<p>Für eine p-Wert Korrektur können wir schlichtweg eine neue Spalte an
den Ergebnisoutput mit <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> hängen. Die korrigierten
p-Werte erhalten wir dabei durch <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust()</a></code>. Die
verschiedenen Korrekturverfahren sind beispielsweise Holm,
Benjamini-Hochberg oder Bonferroni. Exemplarisch gehen wir von
Interaktionen von allen unabhängigen Variablen aus, um mehr p-Werte zum
Vergleichen zu erhalten.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Extraversion</span> <span class="op">~</span> <span class="va">Neurotizismus</span> <span class="op">*</span> <span class="va">Geschlecht</span> <span class="op">*</span> <span class="va">Offenheit</span>, data <span class="op">=</span> <span class="va">big_five</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p_adjusted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 8 × 6</span></span></span>
<span><span class="co">##   term                                estimate std.error stati…¹ p.value p_adj…²</span></span>
<span><span class="co">##   <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>                                  </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> (Intercept)                           5.48       1.56   3.50   5.72</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span><span> 0.004</span><span style="text-decoration: underline;">57</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span><span> Neurotizismus                        -</span><span style="color: #BB0000;">0.495</span><span>      0.454 -</span><span style="color: #BB0000;">1.09</span><span>   2.77</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span><span> 0.554  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span><span> Geschlechtm                          -</span><span style="color: #BB0000;">0.882</span><span>      2.31  -</span><span style="color: #BB0000;">0.381</span><span>  7.03</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span><span> 0.970  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span><span> Offenheit                            -</span><span style="color: #BB0000;">0.744</span><span>      0.466 -</span><span style="color: #BB0000;">1.60</span><span>   1.12</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span><span> 0.448  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span><span> Neurotizismus:Geschlechtm             0.027</span><span style="text-decoration: underline;">2</span><span>     0.719  0.037</span><span style="text-decoration: underline;">8</span><span> 9.70</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span><span> 0.970  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span><span> Neurotizismus:Offenheit               0.153      0.135  1.14   2.56</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span><span> 0.554  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span><span> Geschlechtm:Offenheit                 0.215      0.689  0.312  7.55</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span><span> 0.970  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">8</span><span> Neurotizismus:Geschlechtm:Offenheit   0.014</span><span style="text-decoration: underline;">9</span><span>     0.213  0.069</span><span style="text-decoration: underline;">6</span><span> 9.45</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span><span> 0.970  </span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​statistic, ²​p_adjusted</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="exkurs-faktoren">Exkurs: Faktoren<a class="anchor" aria-label="anchor" href="#exkurs-faktoren"></a>
</h3>
<p>Für Varianzanalysen müssen wir einen bisher nicht erwähnten neuen
Datentyp einführen - den Faktor. Faktoren sind Characters mit
festgelegten Ausprägungsgraden. Wir schauen uns an dieser Stelle nur an,
wie man Faktoren erstellen kann. Dabei greifen wir auf Funktionen aus
dem Kapitel der Datenvorbereitung zu. Der Datensatz für die
Varianzanalysen hat die Variablen <code>iq</code>,
<code>kreativitaet</code>, <code>zeitpunkt</code>, <code>gruppe</code>
und <code>person_id</code>.</p>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 90 × 5</span></span></span>
<span><span class="co">##       iq kreativitaet zeitpunkt gruppe person_id</span></span>
<span><span class="co">##    <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>        </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;fct&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;fct&gt;</span><span>      </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span><span>  96.6         76.2 t1        A              1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span><span> 104.          57.0 t1        B              2</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span><span> 117.          63.5 t1        C              3</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span><span>  91.9         18.6 t1        D              4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span><span> 110.          73.6 t1        E              5</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span><span> 124.          55.5 t1        F              6</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span><span>  97.2         51.4 t1        A              7</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span><span> 104.          71.8 t1        B              8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span><span> 119.          53.8 t1        C              9</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span><span>  92.9         42.3 t1        D             10</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with 80 more rows</span></span></span></code></pre>
<p>Möchten wir nun aus der Gruppenspalte einen Faktor machen, geht dies
mit <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor()</a></code>.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repeated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gruppe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">gruppe</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Angenommen Du möchtest alle Spalten mit Charactern in Faktoren
umformatieren, geht das mit <code><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if()</a></code>.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repeated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span><span class="va">is.character</span>, <span class="va">as.factor</span><span class="op">)</span></span></code></pre></div>
<p>Für mehrere Spalten verwendet man wie gewohnt
<code><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at()</a></code>.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repeated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">zeitpunkt</span>, <span class="va">gruppe</span><span class="op">)</span>, <span class="va">as.factor</span><span class="op">)</span></span></code></pre></div>
<p>Mehr müssen wir auch gar nicht über Faktoren wissen. Ohne Faktoren
können wir jedoch weder Kontraste einstellen noch den Tukey Post-Hoc
Test berechnen; also am besten immer die unabhängigen Variablen bei
Varianzanalysen in Faktoren umwandeln.</p>
</div>
<div class="section level3">
<h3 id="varianzanalysen">Varianzanalysen<a class="anchor" aria-label="anchor" href="#varianzanalysen"></a>
</h3>
<p>Vor jeder Varianzanalyse ohne Messwiederholung laden wir die drei
Packages <code>car</code>, <code>sjstats</code> und
<code>broom</code>.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjstats/" class="external-link">sjstats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span></code></pre></div>
<p>Außerdem müssen wir die Kontraste diagonal einstellen, da wir
ansonsten verzerrte Ergebnisse erhalten können. Dafür einfach den
folgenden Befehl kopieren und in der Form ausführen.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contr.sum"</span>, <span class="st">"poly.sum"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="anova">ANOVA<a class="anchor" aria-label="anchor" href="#anova"></a>
</h4>
<p>Die erste Zeile verändert sich syntaktisch nicht im Verlgeich zu
Regressionmodellen. Nur der Befehl ändert sich zu <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>. In
der zweiten Zeile rufen wir aus dem <code>car</code> Package die
<code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova()</a></code> Funktion auf (beachte das großgeschriebene A),
wordurch wir den Typ der Quadratsummen kontrollieren können. SPSS gibt
zum Beispiel standardmäßig Typ 3 aus, R hingegen normalerweise Typ 1.
Als letztes rufen wir aus dem <code>sjstats</code> Package die Funktion
<code><a href="https://strengejacke.github.io/sjstats/reference/anova_stats.html" class="external-link">anova_stats()</a></code> auf, um unter anderem direkt zusätzlich die
Varianzerklärungen <span class="math inline">\(\eta^2\)</span> zu
erhalten.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">iq</span> <span class="op">~</span> <span class="va">zeitpunkt</span> <span class="op">+</span> <span class="va">gruppe</span>, data <span class="op">=</span> <span class="va">repeated</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://strengejacke.github.io/sjstats/reference/anova_stats.html" class="external-link">anova_stats</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## term      |     sumsq |  meansq | df | statistic | p.value | etasq | partial.etasq | omegasq | partial.omegasq | epsilonsq | cohens.f | power</span></span>
<span><span class="co">## ---------------------------------------------------------------------------------------------------------------------------------------------</span></span>
<span><span class="co">## zeitpunkt |   400.918 | 200.459 |  2 |     1.031 |   0.361 | 0.022 |         0.025 |   0.001 |           0.001 |     0.001 |    0.159 | 0.231</span></span>
<span><span class="co">## gruppe    |  2094.995 | 418.999 |  5 |     2.156 |   0.067 | 0.114 |         0.116 |   0.060 |           0.060 |     0.061 |    0.363 | 0.717</span></span>
<span><span class="co">## Residuals | 15936.917 | 194.353 | 82 |           |         |       |               |         |                 |           |          |</span></span></code></pre>
<div class="section level5">
<h5 id="kontraste-einstellen">Kontraste einstellen<a class="anchor" aria-label="anchor" href="#kontraste-einstellen"></a>
</h5>
<p>Schauen wir zuerst, wie die Kontraste für die Gruppenspalte aussehen.
Innerhalb von <code>constrasts()</code> übergeben wir die gewünschte
Spalte mit gewohnter Dollar-Syntax.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">repeated</span><span class="op">$</span><span class="va">gruppe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">## A    1    0    0    0    0</span></span>
<span><span class="co">## B    0    1    0    0    0</span></span>
<span><span class="co">## C    0    0    1    0    0</span></span>
<span><span class="co">## D    0    0    0    1    0</span></span>
<span><span class="co">## E    0    0    0    0    1</span></span>
<span><span class="co">## F   -1   -1   -1   -1   -1</span></span></code></pre>
<p>Möchtest Du nun die Kontraste anpassen, kannst Du dies manuell
machen. Hierfür verwenden wir erneut <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code>. Dabei wird
zeilenweise unsere Matrix erstellt.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">repeated</span><span class="op">$</span><span class="va">gruppe</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="messwiederholung">Messwiederholung<a class="anchor" aria-label="anchor" href="#messwiederholung"></a>
</h5>
<p>Zur ANOVA mit Messwiederholung laden wir das Package
<code>lmerTest</code>.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR" class="external-link">lmerTest</a></span><span class="op">)</span></span></code></pre></div>
<p>Der Befehl zum Erstellen des Modells ändert sich zu
<code><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer()</a></code>. Ansonsten ist der einzige Unterschied das
Kontrollieren der zufälligen Effekte – hier die zufällig schwankenden
IQ-Ausprägungen zwischen den Personen. Wir kontrollieren dies mit
<code>(1|person_id)</code>. Der Rest bleibt gleich.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">iq</span> <span class="op">~</span> <span class="va">zeitpunkt</span> <span class="op">+</span> <span class="va">gruppe</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">person_id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">repeated</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">##   term        statistic    df p.value</span></span>
<span><span class="co">##   <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>           </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> (Intercept)   </span><span style="text-decoration: underline;">3</span><span>899.       1  0     </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span><span> zeitpunkt        2.88     2  0.237 </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span><span> gruppe           9.47     5  0.091</span><span style="text-decoration: underline;">8</span></span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="manova">MANOVA<a class="anchor" aria-label="anchor" href="#manova"></a>
</h4>
<p>Zum Rechnen multivariater Varianzanalysen wählen wir zuerst die
abhängigen Variablen aus und konvertieren sie zu einer Matrix. Was es
genau mit Matrizen auf sich hat, wird im Kapitel Extras erklärt.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AV</span> <span class="op">&lt;-</span> <span class="va">repeated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">iq</span>, <span class="va">kreativitaet</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Für MANOVAs benötigen wir wieder die <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> Funktion. Das
hängt damit zusammen, dass unter jeder ANOVA eine Regression steckt und
<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> nur eine spezielle Art ist, den <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
Befehl auszuführen. MANOVAs funktionieren nicht mit <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>!
Außerdem ändert sich <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova()</a></code> zu <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Manova()</a></code> und
wir können den Output nicht mit <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> aufräumen.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">AV</span> <span class="op">~</span> <span class="va">gruppe</span> <span class="op">+</span> <span class="va">zeitpunkt</span>, data <span class="op">=</span> <span class="va">repeated</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Manova</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Type III MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">##             Df test stat approx F num Df den Df Pr(&gt;F)    </span></span>
<span><span class="co">## (Intercept)  1   0.98595  2841.28      2     81 &lt;2e-16 ***</span></span>
<span><span class="co">## gruppe       5   0.15931     1.42     10    164 0.1757    </span></span>
<span><span class="co">## zeitpunkt    2   0.03310     0.69      4    164 0.5999    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>Dabei steht <code>Pr(&gt;F)</code> für den p-Wert. Für Vergleiche
innerhalb der jeweiligen abhängigen Variable, benutze
<code><a href="https://rdrr.io/r/stats/summary.aov.html" class="external-link">summary.aov()</a></code>.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">AV</span> <span class="op">~</span> <span class="va">gruppe</span> <span class="op">+</span> <span class="va">zeitpunkt</span>, data <span class="op">=</span> <span class="va">repeated</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/summary.aov.html" class="external-link">summary.aov</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##  Response iq :</span></span>
<span><span class="co">##             Df  Sum Sq Mean Sq F value  Pr(&gt;F)  </span></span>
<span><span class="co">## gruppe       5  2095.0  419.00  2.1559 0.06693 .</span></span>
<span><span class="co">## zeitpunkt    2   400.9  200.46  1.0314 0.36108  </span></span>
<span><span class="co">## Residuals   82 15936.9  194.35                  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Response kreativitaet :</span></span>
<span><span class="co">##             Df  Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">## gruppe       5  1167.0  233.40  0.7401 0.5956</span></span>
<span><span class="co">## zeitpunkt    2   184.7   92.33  0.2928 0.7470</span></span>
<span><span class="co">## Residuals   82 25860.2  315.37</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="kruskal-wallis-test">Kruskal-Wallis Test<a class="anchor" aria-label="anchor" href="#kruskal-wallis-test"></a>
</h4>
<p>Beim nicht-parametrischen Kruskall-Willis Test verändert sich
syntaktisch nichts im Vergleich zu Regressionsmodellen und
Varianzanalysen.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test</a></span><span class="op">(</span><span class="va">iq</span> <span class="op">~</span> <span class="va">gruppe</span>, data <span class="op">=</span> <span class="va">repeated</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   statistic p.value parameter method                      </span></span>
<span><span class="co">##       <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>                       </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>      9.67  0.085</span><span style="text-decoration: underline;">3</span><span>         5 Kruskal-Wallis rank sum test</span></span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="post-hoc-tests">Post-Hoc Tests<a class="anchor" aria-label="anchor" href="#post-hoc-tests"></a>
</h3>
<p>Im folgenden seien zwei mögliche Post-Hoc Vergleiche vorgestellt.</p>
<div class="section level4">
<h4 id="tukeyhsd">TukeyHSD<a class="anchor" aria-label="anchor" href="#tukeyhsd"></a>
</h4>
<p>Für den Test von Tukey auf Honest Significant Differences (HSD)
ändert sich nicht viel im Vergleich zur ANOVA. Nur wird nach der ANOVA
die Funktion <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code> aufgerufen und dann der Output ins
aufgeräumte Format gebracht.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">iq</span> <span class="op">~</span> <span class="va">zeitpunkt</span> <span class="op">*</span> <span class="va">gruppe</span>, data <span class="op">=</span> <span class="va">repeated</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 171 × 7</span></span></span>
<span><span class="co">##    term      contrast null.value estimate conf.low conf.high adj.p.value</span></span>
<span><span class="co">##    <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>         </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>       </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span><span> zeitpunkt t2-t1             0   -</span><span style="color: #BB0000;">5.15</span><span>    -</span><span style="color: #BB0000;">13.8</span><span>       3.47       0.331</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span><span> zeitpunkt t3-t1             0   -</span><span style="color: #BB0000;">2.23</span><span>    -</span><span style="color: #BB0000;">10.9</span><span>       6.39       0.810</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span><span> zeitpunkt t3-t2             0    2.92     -</span><span style="color: #BB0000;">5.70</span><span>     11.5        0.697</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span><span> gruppe    B-A               0    7.45     -</span><span style="color: #BB0000;">7.47</span><span>     22.4        0.689</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span><span> gruppe    C-A               0    3.34    -</span><span style="color: #BB0000;">11.6</span><span>      18.3        0.986</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span><span> gruppe    D-A               0   -</span><span style="color: #BB0000;">2.54</span><span>    -</span><span style="color: #BB0000;">17.5</span><span>      12.4        0.996</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span><span> gruppe    E-A               0   11.4      -</span><span style="color: #BB0000;">3.51</span><span>     26.3        0.233</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span><span> gruppe    F-A               0   -</span><span style="color: #BB0000;">0.124</span><span>   -</span><span style="color: #BB0000;">15.0</span><span>      14.8        1.00 </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span><span> gruppe    C-B               0   -</span><span style="color: #BB0000;">4.11</span><span>    -</span><span style="color: #BB0000;">19.0</span><span>      10.8        0.966</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span><span> gruppe    D-B               0   -</span><span style="color: #BB0000;">9.99</span><span>    -</span><span style="color: #BB0000;">24.9</span><span>       4.93       0.375</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with 161 more rows</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="post-hoc-t-tests">Post-Hoc-t-Tests<a class="anchor" aria-label="anchor" href="#post-hoc-t-tests"></a>
</h4>
<p>Hier müssen wir erneut auf den Dollar Operator zurückgreifen. Als
zusätzliches Argument kann man mit <code>p.adjust.method()</code> die
Korrekturmethode festlegen.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html" class="external-link">pairwise.t.test</a></span><span class="op">(</span><span class="va">repeated</span><span class="op">$</span><span class="va">iq</span>, <span class="va">repeated</span><span class="op">$</span><span class="va">gruppe</span>, </span>
<span>                p.adjust.method <span class="op">=</span>  <span class="st">"none"</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Pairwise comparisons using t tests with pooled SD </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  repeated$iq and repeated$gruppe </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   A      B      C      D      E     </span></span>
<span><span class="co">## B 0.1472 -      -      -      -     </span></span>
<span><span class="co">## C 0.5132 0.4224 -      -      -     </span></span>
<span><span class="co">## D 0.6192 0.0531 0.2512 -      -     </span></span>
<span><span class="co">## E 0.0277 0.4392 0.1171 0.0075 -     </span></span>
<span><span class="co">## F 0.9807 0.1407 0.4978 0.6363 0.0261</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## P value adjustment method: none</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="korrelationskoeffizienten">Korrelationskoeffizienten<a class="anchor" aria-label="anchor" href="#korrelationskoeffizienten"></a>
</h3>
<p>Es gibt einen Unterschied, ob man die Korrelation zwischen zwei
Variablen berechnen (mit p-Wert) oder eine Korrelationstabelle mit allen
Korrelation erhalten möchte.</p>
<div class="section level4">
<h4 id="produkt-moment-korrelation-nach-pearson">Produkt-Moment Korrelation nach Pearson<a class="anchor" aria-label="anchor" href="#produkt-moment-korrelation-nach-pearson"></a>
</h4>
<p>Die Standardeinstellung für <code>cor.test</code> ist die
Produkt-Moment Korrelation nach Pearson. Die Argumente
<code>method</code>, <code>alternative</code> und
<code>conf.level</code> sind also optional.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span>, <span class="va">big_five</span><span class="op">$</span><span class="va">Neurotizismus</span>, </span>
<span>         method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>         alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>         conf.level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 8</span></span></span>
<span><span class="co">##   estimate statistic p.value parameter conf.low conf.high method         alter…¹</span></span>
<span><span class="co">##      <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>          </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>   0.069</span><span style="text-decoration: underline;">7</span><span>     0.984   0.327       198  -</span><span style="color: #BB0000;">0.069</span><span style="color: #BB0000;text-decoration: underline;">7</span><span>     0.206 Pearson's pro… two.si…</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable name ¹​alternative</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="rangkorrelation-nach-spearman">Rangkorrelation nach Spearman<a class="anchor" aria-label="anchor" href="#rangkorrelation-nach-spearman"></a>
</h4>
<p>Für die Rangkorrelation nach Spearman muss man lediglich das
<code>method</code> Argument entsprechend anpassen (natürlich müssen die
Variablen eigentlich ordinal sein).</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span>, <span class="va">big_five</span><span class="op">$</span><span class="va">Neurotizismus</span>, </span>
<span>         method <span class="op">=</span> <span class="st">"spearman"</span>,</span>
<span>         alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>         conf.level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in cor.test.default(big_five$Extraversion, big_five$Neurotizismus, :</span></span>
<span><span class="co">## Cannot compute exact p-value with ties</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   estimate statistic p.value method                          alternative</span></span>
<span><span class="co">##      <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>                           </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>      </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>   0.048</span><span style="text-decoration: underline;">7</span><span>  1</span><span style="text-decoration: underline;">268</span><span>305.   0.493 Spearman's rank correlation rho two.sided</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="korrelationstabellen">Korrelationstabellen<a class="anchor" aria-label="anchor" href="#korrelationstabellen"></a>
</h4>
<p>Nun kann es schon mal vorkommen, dass man mehr als zwei Variablen
miteinander in einer Korrelationstabelle untersuchen möchte. Zuerst
wählen wir im <code>repeated</code> Datensatz alle numerischen Spalten
aus.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repeated_num</span> <span class="op">&lt;-</span> <span class="va">repeated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">select_if</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span></span></code></pre></div>
<p>Dann verwenden wir die Funktion <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor()</a></code>.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">repeated_num</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##                       iq kreativitaet   person_id</span></span>
<span><span class="co">## iq            1.00000000   0.01162833 -0.15539732</span></span>
<span><span class="co">## kreativitaet  0.01162833   1.00000000  0.03990274</span></span>
<span><span class="co">## person_id    -0.15539732   0.03990274  1.00000000</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="kontingenztafeln">Kontingenztafeln<a class="anchor" aria-label="anchor" href="#kontingenztafeln"></a>
</h3>
<p>Eine Kontigenztafel erstellt man einfach mit <code><a href="https://rdrr.io/r/base/table.html" class="external-link">table()</a></code>.
Möchten wir zum Beispiel wissen, welches der Geschlechter häufiger eine
starke Ausprägung von Extraversion mit über 3.5 haben, schreiben wir
einfach</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">big_five</span><span class="op">$</span><span class="va">Geschlecht</span>, <span class="va">big_five</span><span class="op">$</span><span class="va">Extraversion</span> <span class="op">&gt;</span> <span class="fl">3.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    </span></span>
<span><span class="co">##     FALSE TRUE</span></span>
<span><span class="co">##   f   108   10</span></span>
<span><span class="co">##   m    76    6</span></span></code></pre>
<p>Schauen wir uns nun an, wie man Kontigenztafeln analysiert.
Angenommen wir haben vorherige Kontingenztafel als <code>tbl</code>
gespeichert.</p>
<div class="section level4">
<h4 id="fisher-exact-test">Fisher-exact Test<a class="anchor" aria-label="anchor" href="#fisher-exact-test"></a>
</h4>
<p>Für den Fisher-Exact Test für <span class="math inline">\(2\times2\)</span> Kontigenztafeln, müssen wir nun
lediglich unsere Kontingenztafel <code>tbl</code> der Funktion
<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test()</a></code> übergeben. Auch hier bereinigen wir den
Output mit <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##   estimate p.value conf.low conf.high method                             alter…¹</span></span>
<span><span class="co">##      <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>                              </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>    0.853       1    0.244      2.72 Fisher's Exact Test for Count Data two.si…</span></span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable name ¹​alternative</span></span></span></code></pre>
<p>Die Spalte <code>estimate</code> im Output ist in dem Fall die Odds
ratio.</p>
</div>
<div class="section level4">
<h4 id="mcnemars-chi2-test">Mcnemars <span class="math inline">\(\chi^2\)</span> Test<a class="anchor" aria-label="anchor" href="#mcnemars-chi2-test"></a>
</h4>
<p>Das gleiche gilt für den Mcenamr Test. Hier sparen wir uns
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>, weil der Output ohnehin bereits schön aufgeräumt
aussieht.</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/mcnemar.test.html" class="external-link">mcnemar.test</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  McNemar's Chi-squared test with continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  tbl</span></span>
<span><span class="co">## McNemar's chi-squared = 49.128, df = 1, p-value = 2.398e-12</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="pearsons-chi2-test">Pearsons <span class="math inline">\(\chi^2\)</span> Test<a class="anchor" aria-label="anchor" href="#pearsons-chi2-test"></a>
</h4>
<p>Und auch beim asymptotischen <span class="math inline">\(\chi^2\)</span>-Test nach Pearson läuft es nach
dem selben Schema ab.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test with Yates' continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  tbl</span></span>
<span><span class="co">## X-squared = 0.001011, df = 1, p-value = 0.9746</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="explorative-faktorenanalyse">Explorative Faktorenanalyse<a class="anchor" aria-label="anchor" href="#explorative-faktorenanalyse"></a>
</h2>
<p>Kommen wir nun zum letzten Thema – der explorativen Faktorenanalyse.
Dabei betrachten wir zwei Verfahren: die Principal Component Analysis
(PCA) und die Maximum Likelihood Faktorenanalyse (EFA). Zuerst wählen
wir alle numerischen Spalten aus dem <code>big_five</code> Datensatz aus
(alle anderen sind unbrauchbar).</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_data</span> <span class="op">&lt;-</span> <span class="va">big_five</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">select_if</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="naive-hauptkomponentenanalyse">Naive Hauptkomponentenanalyse<a class="anchor" aria-label="anchor" href="#naive-hauptkomponentenanalyse"></a>
</h3>
<p>Für die naive Hauptkomponentenanalyse (PCA) muss man keine Annahmen
über die Faktorenanzahl treffen. Das einzige Argument, was man der
Funktion <code><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp()</a></code> übergeben muss, ist der Datensatz.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></span><span class="op">(</span><span class="va">num_data</span><span class="op">)</span></span></code></pre></div>
<p>Die Ladungen der Faktoren auf die Komponenten erhalten wir mit
<code><a href="https://rdrr.io/r/stats/loadings.html" class="external-link">loadings()</a></code>.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/loadings.html" class="external-link">loadings</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Loadings:</span></span>
<span><span class="co">##                    Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6</span></span>
<span><span class="co">## Alter               1.000                                   </span></span>
<span><span class="co">## Extraversion                     -0.609  0.300         0.726</span></span>
<span><span class="co">## Neurotizismus              0.980  0.150  0.127              </span></span>
<span><span class="co">## Vertraeglichkeit                 -0.673        -0.502 -0.535</span></span>
<span><span class="co">## Gewissenhaftigkeit         0.153 -0.391 -0.509  0.719 -0.218</span></span>
<span><span class="co">## Offenheit                               -0.794 -0.472  0.373</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6</span></span>
<span><span class="co">## SS loadings     1.000  1.000  1.000  1.000  1.000  1.000</span></span>
<span><span class="co">## Proportion Var  0.167  0.167  0.167  0.167  0.167  0.167</span></span>
<span><span class="co">## Cumulative Var  0.167  0.333  0.500  0.667  0.833  1.000</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="maximum-likelihood-faktorenanalyse">Maximum Likelihood Faktorenanalyse<a class="anchor" aria-label="anchor" href="#maximum-likelihood-faktorenanalyse"></a>
</h3>
<p>Bei einer EFA muss man die Faktorenanzahl und die Rotationsart
festlegen. Bei 5 erwarteten Faktoren und einer orthogonalen Rotation
erhält man die Faktorenanalyse mit <code><a href="https://rdrr.io/r/stats/factanal.html" class="external-link">factanal()</a></code> wie folgt</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/factanal.html" class="external-link">factanal</a></span><span class="op">(</span><span class="va">num_data</span>, factors <span class="op">=</span> <span class="fl">2</span>, rotation <span class="op">=</span> <span class="st">"varimax"</span><span class="op">)</span></span></code></pre></div>
<p>Möchte man im Output übersichtlich nur Werte mit 2 Nachkommastellen
in absteigender Form mit Werten größer 0.3, benutzt man
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fac</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, cutoff <span class="op">=</span> <span class="fl">0.3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## factanal(x = num_data, factors = 2, rotation = "varimax")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Uniquenesses:</span></span>
<span><span class="co">##              Alter       Extraversion      Neurotizismus   Vertraeglichkeit </span></span>
<span><span class="co">##               0.96               0.00               0.91               0.77 </span></span>
<span><span class="co">## Gewissenhaftigkeit          Offenheit </span></span>
<span><span class="co">##               0.76               0.76 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Loadings:</span></span>
<span><span class="co">##                    Factor1 Factor2</span></span>
<span><span class="co">## Extraversion        0.97          </span></span>
<span><span class="co">## Alter                             </span></span>
<span><span class="co">## Neurotizismus                     </span></span>
<span><span class="co">## Vertraeglichkeit    0.46          </span></span>
<span><span class="co">## Gewissenhaftigkeit  0.30    0.39  </span></span>
<span><span class="co">## Offenheit                   0.49  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                Factor1 Factor2</span></span>
<span><span class="co">## SS loadings       1.26    0.58</span></span>
<span><span class="co">## Proportion Var    0.21    0.10</span></span>
<span><span class="co">## Cumulative Var    0.21    0.31</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Test of the hypothesis that 2 factors are sufficient.</span></span>
<span><span class="co">## The chi square statistic is 5.13 on 4 degrees of freedom.</span></span>
<span><span class="co">## The p-value is 0.274</span></span></code></pre>
<p>Möchte man mit den Ergebnissen weiterrechen, kann man auch hier
wieder <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> verwenden.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fac</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   variable           uniqueness     fl1    fl2</span></span>
<span><span class="co">##   <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>                   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span> Alter                   0.960 -</span><span style="color: #BB0000;">0.028</span><span style="color: #BB0000;text-decoration: underline;">1</span><span>  0.199</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span><span> Extraversion            0.005  0.970  -</span><span style="color: #BB0000;">0.234</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span><span> Neurotizismus           0.912  0.136   0.264</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span><span> Vertraeglichkeit        0.766  0.457   0.157</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span><span> Gewissenhaftigkeit      0.755  0.300   0.393</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span><span> Offenheit               0.763 -</span><span style="color: #BB0000;">0.021</span><span style="color: #BB0000;text-decoration: underline;">7</span><span>  0.486</span></span></span></code></pre>
<p>Das Kaiser-Maier-Olkin Kriterium erhält mit man mit der
<code>KMO()</code> Funktion aus dem <code>psych</code> Package.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">KMO</span><span class="op">(</span><span class="va">num_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Kaiser-Meyer-Olkin factor adequacy</span></span>
<span><span class="co">## Call: KMO(r = num_data)</span></span>
<span><span class="co">## Overall MSA =  0.51</span></span>
<span><span class="co">## MSA for each item = </span></span>
<span><span class="co">##              Alter       Extraversion      Neurotizismus   Vertraeglichkeit </span></span>
<span><span class="co">##               0.43               0.48               0.61               0.52 </span></span>
<span><span class="co">## Gewissenhaftigkeit          Offenheit </span></span>
<span><span class="co">##               0.60               0.45</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="scree-plot">Scree Plot<a class="anchor" aria-label="anchor" href="#scree-plot"></a>
</h3>
<p>Den Scree Plot erhalten wir nach Laden von <code>rBasics</code> mit
<code><a href="../reference/scree_plot.html">scree_plot()</a></code>. Dabei gibt die Funktion einen ggplot
zurück.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scree_plot.html">scree_plot</a></span><span class="op">(</span><span class="va">num_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span><span> Please use `linewidth` instead.</span></span></span></code></pre>
<p><img src="05_Inferenzstatistik_files/figure-html/unnamed-chunk-65-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Wir erinnern uns, alle Graphen aus dem Package <code>ggpubr</code>
(siehe Kapitel Visualisierungen) basieren auf <code>ggplot2</code>. Das
heißt, wir können den Graphen ganz normal mit <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggpar.html" class="external-link">ggpar()</a></code>
anpassen. Angenommen wir hätten den Graphen als <code>plot</code>
gespeichert, könnten wir die Parameter einfach anpassen mit</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggpar.html" class="external-link">ggpar</a></span><span class="op">(</span><span class="va">plot</span>, </span>
<span>      font.x <span class="op">=</span> <span class="fl">14</span>, </span>
<span>      font.y <span class="op">=</span> <span class="fl">14</span>, </span>
<span>      font.tickslab <span class="op">=</span> <span class="fl">14</span>,</span>
<span>      ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">1.6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="05_Inferenzstatistik_files/figure-html/unnamed-chunk-67-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan Philipp Nolte.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
